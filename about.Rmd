---
title: "Análisis descriptivo de los casos registrados de violencia de género entre 2015 y 2023"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
    code_download: true
    theme: lumen
    number_sections: true
    css: styles.css
---
```{r setup, include=FALSE}
library(tidyverse)
library(janitor)
library(flextable)
library(knitr)
library(kableExtra)
library(dplyr)
violencia_genero <- read_csv("Violencia_genero_6.csv")
knitr::opts_chunk$set(echo = TRUE) 
```
```{css,echo=FALSE}
.column {display:flex;}
h1{color:rgb(26, 72, 112)}
h2{color:rgb(26, 72, 112)}
h3{color:rgb(26, 72, 112)}
```

El análisis de los casos registrados de violencia de género en Colombia entre 2015 y 2023 es esencial para comprender los patrones demográficos y contextuales que influyen en la ocurrencia de estos incidentes. A través de este análisis, se busca identificar los perfiles de riesgo de las víctimas y los agresores, así como los factores situacionales que intervienen en la dinámica de la violencia de género en el país. El objetivo principal es desentrañar las tendencias y distribuciones dentro de los casos registrados, que permitan comprender cómo variables demográficas, tales como edad, sexo, ciclo de vida y otros factores sociodemográficos, influyen en la vulnerabilidad de las víctimas y en la definición de los perfiles de los agresores. Para ello, se realizarán análisis estadísticos descriptivos complementados con modelos probabilísticos y estadísticos relacionados, que permitirán identificar de manera clara los factores de riesgo asociados a las víctimas y agresores. Estas herramientas estadísticas serán fundamentales para esclarecer las relaciones significativas entre las variables, como el impacto de los factores sociodemográficos en la ocurrencia de la violencia, proporcionando una visión más detallada y precisa de los determinantes que contribuyen a la violencia de género en Colombia.

# Análisis inicial de los casos de violencia de género registrados

En Colombia, la violencia de género constituye un desafío significativo que afecta a diversas poblaciones. Este análisis descriptivo inicial se enfoca en los casos de violencia de género registrados entre 2015 y 2023, proporcionando un panorama general sobre la situación en el país. Se examinará la cantidad total de casos, desglosándolos por los diferentes tipos de violencia, como "abuso sexual", "violación" y "violencia física", entre otros. También se tendrán en cuenta las fluctuaciones anuales en la incidencia de estos casos, lo que permitirá identificar patrones y tendencias a lo largo del tiempo. Este enfoque estadístico inicial busca ofrecer una contextualización para las siguientes exploraciones descriptivas demográficas y situacionales de los casos de violencia de género registrados en la base de datos. A continuación, se presenta el número de casos registrados en los años de estudio:

```{r,echo=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)

tipo_violencia_counts <- violencia_genero %>%
  count(def_naturaleza) %>%
  arrange(desc(n))  

ggplot(tipo_violencia_counts, aes(x = reorder(def_naturaleza, n), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = n), hjust = -0.2, color = "black", size = 3.5) + 
  coord_flip() +  
  labs(title = "Frecuencia de Casos de Violencia\npor Tipo de Violencia",
       x = "Tipo de Violencia",
       y = "Casos Registrados") +
  theme_classic() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title.x = element_text(face = "bold", size = 12),
    axis.title.y = element_text(face = "bold", size = 12),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.line = element_line(color = "gray50", size = 0.5), 
    panel.grid.major.x = element_line(color = "gray80", size = 0.3), 
    panel.grid.minor = element_blank()  
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)), limits = c(0, 6000))

```

Como se observa en la gráfica, la frecuencia de casos de violencia de género registrados en Colombia está marcada por una distribución desigual entre los diferentes tipos de violencia. La categoría de "Negligencia y abandono" es la más predominante, con 4,746 casos, lo que indica una gran cantidad de situaciones donde los menores están en riesgo debido a la falta de cuidado adecuado. Este alto número podría sugerir problemas sistémicos en la protección infantil, como la insuficiencia de recursos para las familias en situaciones de vulnerabilidad o la falta de intervención oportuna por parte de las autoridades competentes. La "Violencia física" también presenta un número significativo de casos, alcanzando 4,028, lo que sugiere que este tipo de abuso es una de las formas más comunes de violencia de género reportadas. Otras categorías, como el "Abuso sexual" con 953 casos y "Violencia psicológica" con 544 casos, reflejan un número considerable de incidentes que requieren atención. Además, la categoría "Sin información" presenta 638 casos, lo que indica que en muchos registros faltan detalles críticos que podrían ayudar a entender mejor la naturaleza de la violencia. Las modalidades menos comunes, como la "Explotación sexual, comercial de niños y adolescentes" (3 casos) y "Trata de personas" (1 caso), aunque representan una menor cantidad de incidentes, destacan la necesidad de vigilancia continua y recursos específicos para abordar estas cuestiones.

Esto, traducido en términos de probabilidad, proporciona un contexto cuantitativo que facilita la comprensión de la magnitud de cada tipo de violencia, lo que se presentará en la siguiente tabla:

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(dplyr)
library(kableExtra)

violencia_datos_vi <- data.frame(
  tipo_violencia = c("Negligencia y abandono", "Violencia física", "Abuso sexual", 
                     "Sin información", "Violencia psicológica", "Acoso sexual", 
                     "Actos sexuales", "Violación", "Acceso carnal", 
                     "Actos sexuales de violencia", "Otras violencias sexuales", 
                     "Otros actos sexuales", "Sin información", "Desconocida", 
                     "Explotación sexual, comercial de niños y adolescentes", 
                     "Trata de personas"),
  casos = c(4746, 4028, 953, 630, 544, 287, 260, 239, 230, 
            118, 96, 45, 8, 5, 3, 1)
)

total_casos_vi <- sum(violencia_datos_vi$casos)

tabla_probabilidades_vi <- violencia_datos_vi %>%
  mutate(
    probabilidad = round(casos / total_casos_vi, 4),
    porcentaje = paste0(round(probabilidad * 100, 2), "%"),
    enunciado = paste0("P(<span style='font-size:0.8em; font-weight:bold; font-style:italic;'>", 
                       tipo_violencia, "</span>)")  # Formatear el enunciado en HTML
  ) %>%
  select(enunciado, probabilidad, porcentaje)  

caption_text_vi <- "Probabilidad de ser víctima de un tipo de violencia según la etapa de vida"

tabla_probabilidades_vi %>%
  kable("html", align = "c", digits = 4, 
        col.names = c("Enunciado", "Probabilidad", "Porcentaje"),  
        caption = caption_text_vi, escape = FALSE) %>%  
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")  


```

La tabla de probabilidades presentada revela que las víctimas son más propensas a experimentar ciertos tipos de violencia, destacando la negligencia y el abandono como el tipo más común, con una probabilidad de 0.3892 (38.92%). Esto sugiere que casi 4 de cada 10 víctimas enfrentan este tipo de violencia, lo que indica que la negligencia y el abandono son problemas serios que requieren atención inmediata. La violencia física también es notable, con una probabilidad de 0.3304 (33.04%), reflejando que aproximadamente 1 de cada 3 víctimas experimenta esta forma de violencia, lo que resalta la necesidad de políticas y programas de intervención que aborden este problema de manera efectiva. Aunque el abuso sexual tiene una probabilidad más baja de 0.0728 (7.28%), sigue siendo una preocupación significativa. Además, la categoría sin información representa 0.5117 (5.17%) de los casos, lo que indica una falta de datos precisos sobre el tipo de violencia que las víctimas están experimentando y limita la capacidad de respuesta de las autoridades y organizaciones dedicadas a la prevención y tratamiento de la violencia.Por otro lado, al analizar los tipos de violencia menos frecuentes, como la violación (1.96%) y el acceso carnal (1.89%), se observa que, aunque su prevalencia es menor, estas formas de violencia son extremadamente graves.

Con lo que respecta a la frecuencia de ocurrencia de los casos de violencia de género por los años de estudio, como se observa en la tabla inferior, aunque 2016 fue el año con la mayor cantidad de casos, alcanzando 2146, se observa una disminución gradual en los años siguientes, llegando a 1101 casos en 2018 y culminando en 420 casos en 2023. Esta caída podría interpretarse como una mejora en la situación de la violencia; sin embargo, es fundamental considerar que este descenso puede no reflejar la realidad completa. Factores como el subregistro de casos, cambios en los procedimientos de denuncia y barreras para que las víctimas accedan a servicios de apoyo pueden haber contribuido a la baja en los números reportados.

```{r,echo=FALSE,warning=TRUE}
library(ggplot2)
library(dplyr)

violencia_por_ano <- violencia_genero %>%
  count(año) %>%
  arrange(año)

ggplot(violencia_por_ano, aes(x = as.factor(año), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = n), vjust = -0.2, color = "black", size = 3.5) +
  labs(title = "Frecuencia de Casos de Violencia por Año",
       x = "Año",
       y = "Casos Registrados") +
  theme_classic() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title.x = element_text(face = "bold", size = 12),
    axis.title.y = element_text(face = "bold", size = 12),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.line = element_line(color = "gray50", size = 0.5),
    panel.grid.major.y = element_line(color = "gray80", size = 0.3),
    panel.grid.minor = element_blank()
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) 

```

# Análisis descriptivos demográficos generales de víctimas de violencia de género en colombia entre los años 2015-2023

Esta sección presenta un análisis descriptivo de los casos de violencia de género en Colombia durante el periodo 2015-2023. Se examinan las características demográficas de las víctimas, incluyendo edad, sexo y tipo de violencia experimentada, con el fin de identificar tendencias y patrones significativos. El análisis se basa en técnicas estadísticas que permiten obtener una comprensión integral de la situación actual de la violencia de género en el país, destacando las variaciones a lo largo del tiempo y entre diferentes grupos demográficos. 

## Análisis general de casos de violencia por edades y ciclo de vida de las víctimas

En este apartado se realiza un análisis estadístico de las edades de las víctimas de violencia, enfocándose en la frecuencia, medidas de tendencia central, distribución y variabilidad. Este análisis busca identificar los grupos etarios en los que se concentran más los casos de violencia a nivel nacional y perfilar las edades más susceptibles, conforme a los datos de la base. Al explorar estos aspectos estadísticos, se pretende obtener una comprensión precisa de la demografía de las víctimas y de cómo se distribuyen los casos de violencia de género en los años 2015-2023.

### Casos registrados por intervalo de edades y etapas de vida de las víctimas

```{r, echo=FALSE, warning=FALSE}
library(dplyr)
library(kableExtra)

violencia_genero$edad_victima <- as.numeric(as.character(violencia_genero$edad_victima))
violencia_genero <- violencia_genero %>% filter(!is.na(edad_victima) & edad_victima >= 0 & edad_victima <= 100)

violencia_genero$edad_intervalo <- cut(
  violencia_genero$edad_victima, 
  breaks = c(seq(0, 90, by = 10), 100), 
  labels = c("[0-10)", "[10-20)", "[20-30)", "[30-40)", "[40-50)", "[50-60)", "[60-70)", "[70-80)", "[80-90)", "[90-100]"),
  right = FALSE,  
  include.lowest = TRUE 
)

tabla_frecuencia <- violencia_genero %>%
  group_by(edad_intervalo) %>%
  summarise(
    fi = n(),
    hi = round(fi / nrow(violencia_genero), 4)
  ) %>%
  mutate(
    Fi = cumsum(fi),
    Hi = round(cumsum(hi), 4),
    `hi (%)` = round(hi * 100, 4),     # Nombres con caracteres especiales usando comillas invertidas
    `Hi (%)` = round(Hi * 100, 4)
  )

tabla_frecuencia %>%
  kable("html", align = "c", digits = 4, caption = "Tabla de Frecuencia de Edades de las Víctimas") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), full_width = F, position = "center") %>%
  row_spec(0, bold = T, background = "#d0e4f5")


```

La tabla de frecuencia de edades de las víctimas ofrece una visión detallada de la distribución etaria, destacando la vulnerabilidad en ciertos grupos de edad. Los datos están organizados en intervalos de diez años, con frecuencias absolutas y relativas, además de frecuencias acumuladas y sus porcentajes, lo que permite identificar patrones claros en la concentración de víctimas por edad. El grupo de 0-10 años sobresale con la mayor cantidad de casos, representando el 38.72% del total de víctimas, seguido del grupo de 10-20 años con el 27.0%. En conjunto, estos dos intervalos abarcan casi dos tercios de las víctimas, acumulando un 65.72% del total en los primeros 20 años de vida. Este patrón muestra una alta concentración de víctimas en las edades más jóvenes, lo cual es un dato significativo para entender la vulnerabilidad en la población infantil y juvenil.

A medida que se avanza en los rangos de edad, la frecuencia de víctimas disminuye notablemente. El grupo de 20-30 años representa solo el 15.77%, y cada intervalo posterior continúa disminuyendo, hasta alcanzar solo un 0.85% en el grupo de 90-100 años. Este descenso progresivo sugiere que la incidencia de victimización es mucho menor en edades avanzadas, consolidando la alta concentración de casos en los primeros años de vida.En resumen, esta tabla evidencia que la mayoría de las víctimas se concentran en las edades más jóvenes, con un descenso claro y progresivo en los grupos de mayor edad. Los primeros 20 años abarcan casi dos tercios de las víctimas, lo que indica una alta vulnerabilidad en estas edades. La acumulación de frecuencias en los primeros años refleja la importancia de este grupo etario dentro del conjunto de víctimas, destacando la vulnerabilidad de la población infantil y juvenil en los casos registrados. A continuación, se puede observar de mejor manera la distribución de las edades de las víctimas de los diferentes tipos de violencia de género:

```{r, echo=FALSE, warning=FALSE}
df_edadesvic <- data.frame(edadesvic_simetria = violencia_genero$edad_victima)
ggplot(df_edadesvic, aes(x = edadesvic_simetria)) +
  geom_histogram(aes(y = ..density..), breaks = seq(0, 100, by = 10), fill = "lightblue", color = "black", alpha = 0.5) +
  geom_density(color = "darkblue", size = 1) +
  labs(title = "Gráfica de Densidad e Histograma de Edades", x = "Edades", y = "Densidad") +
  theme_minimal() +
  theme(
    axis.line = element_line(color = "black"),
    axis.ticks = element_line(color = "black"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    plot.margin = margin(10, 10, 10, 10),
    plot.title = element_text(hjust = 0.5)
  ) +
  scale_x_continuous(breaks = seq(0, 100, by = 10), limits = c(0, 100), expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0))

```

Como se puede observar, la mayor concentración de edades se encuentra entre los 0 y 20 años, con una caída gradual hacia edades mayores, lo que sugiere que las víctimas son predominantemente jóvenes, con una disminución significativa en las edades más avanzadas. La distribución no sigue una distribución normal simétrica. En cambio, tiene una forma sesgada a la derecha, lo que indica que la mayoría de las víctimas tienen edades menores, mientras que las personas de mayor edad son mucho menos representadas. Este patrón podría sugerir que los tipos de violencia que afectan a personas más jóvenes (como niños y adolescentes) son más prevalentes. Además, la baja frecuencia en las edades mayores podría reflejar un menor número de registros o una menor incidencia de violencia en esas edades. En resumen, la gráfica resalta la alta vulnerabilidad de las personas jóvenes frente a ciertos tipos de violencia, mientras que las personas mayores parecen ser menos afectadas en comparación.

Estos hallazgos sobre la prevalencia de la violencia en los grupos más jóvenes se pueden corroborar con el análisis de frecuencia de casos registrados por ciclo de vida de la víctima. Este análisis revela patrones similares, destacando cómo la violencia afecta desproporcionadamente a la infancia y la juventud. Tal correlación subraya la necesidad de abordar la violencia en función de las características específicas de cada etapa del ciclo de vida, como se muestra a continuación:

```{r,echo=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)

ciclo_vida_counts <- violencia_genero %>%
  count(`Ciclo de vida`) %>%
  arrange(desc(n))

ggplot(ciclo_vida_counts, aes(x = reorder(`Ciclo de vida`, n), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = n), hjust = -0.2, color = "black", size = 3.5) + # Etiquetas de frecuencia
  coord_flip() +
  labs(title = "Frecuencia de casos de violencia por ciclo de vida de la víctima",
       x = "Ciclo de Vida de la Víctima",
       y = "Casos Registrados") +
  theme_classic() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title.x = element_text(face = "bold", size = 12),
    axis.title.y = element_text(face = "bold", size = 12),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.line = element_line(color = "gray50", size = 0.5), 
    panel.grid.major.x = element_line(color = "gray80", size = 0.3), 
    panel.grid.minor = element_blank() 
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) 


```

La gráfica de frecuencia de casos de violencia por ciclo de vida de la víctima refuerza las observaciones previas sobre la vulnerabilidad de los grupos más jóvenes. La primera infancia presenta la mayor frecuencia de casos, con 3,687 incidentes, seguida por la juventud con 2,302 y la adolescencia con 2,253. Si sumamos los casos de infancia, primera infancia, adolescencia y juventud, se observa que estos grupos en conjunto representan una proporción significativa de las víctimas de violencia registradas entre los años 2015-2023, lo que resalta la preocupación por la exposición de los jóvenes a situaciones de riesgo. En contraste, los grupos de edad más avanzada, como la adultez (2,045) y las personas mayores (370), muestran una representación considerablemente menor. Esto evidencia que, aunque la violencia afecta a todas las etapas de la vida, los más jóvenes son, sin duda, los más expuestos, lo que subraya la urgencia de abordar esta problemática de manera integral. 

Ahora bien, traduciendo estos datos en términos probabilísticos, de acuerdo a la tabla inferior, se puede afirmar que la "Primera infancia" presenta la mayor probabilidad de victimización por violencia de género, con un 30.24%. En términos comparativos, los jóvenes en "Juventud" (18.88%) y "Adolescencia" (18.48%) también muestran probabilidades elevadas de ser víctimas. En contraste, las probabilidades disminuyen en los grupos de "Adultez" (16.77%) e "Infancia" (12.60%), y son más bajas en "Persona Mayor" (3.03%). Esto sugiere una distribución no uniforme del riesgo, donde los más jóvenes son más propensos a experimentar violencia de género, destacando la necesidad de enfoques de prevención adaptados a cada grupo etario.

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(dplyr)
library(kableExtra)

violencia_datos_etapa <- data.frame(
  ciclo_vida = c("Primera infancia", "Juventud", "Adolescencia", "Adultez", "Infancia", "Persona Mayor"),
  casos = c(3687, 2302, 2253, 2045, 1536, 370)
)

total_casos_etapa <- sum(violencia_datos_etapa$casos)

tabla_probabilidades_etapa <- violencia_datos_etapa %>%
  mutate(
    probabilidad = round(casos / total_casos_etapa, 4),
    porcentaje = paste0(round(probabilidad * 100, 2), "%")  
  ) %>%
  select(ciclo_vida, probabilidad, porcentaje)  

tabla_probabilidades_etapa %>%
  kable("html", align = "c", digits = 4, 
        col.names = c("Ciclo de Vida", "Probabilidad", "Porcentaje"),  
        caption = "Probabilidades de ser víctima de algún tipo de violencia de género por etapa de vida") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")


```

### Estadísticos de edades de las víctimas por tipo de violencia de género

```{r,echo=FALSE,warning=FALSE}

library(dplyr)
library(kableExtra)

violencia_genero$def_naturaleza <- as.factor(violencia_genero$def_naturaleza)

estadisticos_por_naturaleza <- violencia_genero %>%
  group_by(def_naturaleza) %>%
  summarise(
    `Tipo de Violencia` = first(def_naturaleza), 
    `Media de Edad` = mean(edad_victima, na.rm = TRUE),
    `Mediana de Edad` = median(edad_victima, na.rm = TRUE),
    `Moda de Edad` = as.numeric(names(sort(table(edad_victima), decreasing = TRUE)[1])),
    `Desviación Estándar` = sd(edad_victima, na.rm = TRUE),
    `Varianza` = var(edad_victima, na.rm = TRUE),
    `Coeficiente de Variación` = (sd(edad_victima, na.rm = TRUE) / mean(edad_victima, na.rm = TRUE)) * 100,
    `Cuartil 1` = quantile(edad_victima, 0.25, na.rm = TRUE),
    `Cuartil 2` = quantile(edad_victima, 0.5, na.rm = TRUE),
    `Cuartil 3` = quantile(edad_victima, 0.75, na.rm = TRUE)
  )

estadisticos_por_naturaleza %>%
  select(`Tipo de Violencia`, `Media de Edad`, `Mediana de Edad`, `Moda de Edad`, `Desviación Estándar`, `Varianza`, `Coeficiente de Variación`, `Cuartil 1`, `Cuartil 2`, `Cuartil 3`) %>%
  kable("html", align = "c", digits = 2, 
        caption = "Estadísticos de Edad de las Víctimas por Tipo de Violencia") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")


```

La tabla ofrece un análisis estadístico exhaustivo de la edad de las víctimas según el tipo de violencia, proporcionando una comprensión detallada de cómo se distribuyen las edades en cada categoría de agresión. En cuanto a las medidas de centralización, se observa que el "Abuso Sexual" tiene una media de edad de 12.65 años y una mediana de 13, lo que indica que afecta principalmente a menores de edad. De manera similar, la "Explotación Sexual Comercial de Niños y Adolescentes" presenta una media aún más baja, de 7.67 años, y una mediana de solo 3 años, lo que refleja que las víctimas de este tipo de violencia suelen ser niños muy pequeños. En contraste, la "Violencia Física" y la "Violencia Psicológica" afectan a grupos de mayor edad, con medias de 29.58 y 27.99 años, respectivamente. Esto sugiere que estos tipos de violencia son más frecuentes en adultos y en etapas de vida con interacciones sociales y laborales más complejas.

Las medidas de dispersión, como la desviación estándar y la varianza, revelan la variabilidad en la edad de las víctimas para cada tipo de violencia. La "Negligencia y Abandono" muestra una alta desviación estándar (16.09) y varianza (258.87), lo que indica una gran dispersión en las edades de las víctimas. Esto implica que este tipo de violencia afecta a personas de un amplio rango etario, desde la infancia hasta la vejez, lo cual puede estar relacionado con la dependencia que tanto los jóvenes como los adultos mayores tienen hacia sus cuidadores. En contraste, tipos de violencia como el "Acoso Sexual" y los "Actos Sexuales" muestran menor variabilidad relativa en la edad de sus víctimas, concentrándose en edades juveniles y reflejando una distribución más homogénea en estos grupos.

Los percentiles, expresados como cuartiles, proporcionan una visión más detallada sobre la distribución etaria dentro de cada tipo de violencia, revelando patrones específicos para diferentes grupos. En el caso del Abuso Sexual, el primer cuartil de 6 años y el tercer cuartil de 16 años muestran que la mayoría de las víctimas son personas jóvenes, confirmando que este tipo de violencia afecta predominantemente a menores de edad. Por otro lado, la Violencia Física tiene un rango intercuartílico de 21 a 45 años, lo cual indica que se presenta principalmente en adultos jóvenes y de mediana edad, posiblemente debido a interacciones familiares o sociales más frecuentes en estas etapas. La Violencia Psicológica se concentra entre los 14 y 40 años, lo que sugiere que las víctimas suelen estar en etapas de vida con interacciones sociales y laborales intensas, donde los conflictos emocionales pueden ser más frecuentes. En cuanto a la Negligencia y Abandono, se observa un rango de edad aún más amplio, con un primer cuartil de 2 años y un tercer cuartil de 12 años, lo cual indica que una gran proporción de las víctimas son niños y adolescentes en etapas de desarrollo.

En resumen, los tipos de violencia sexual, como el abuso y el acoso, afectan predominantemente a menores y adolescentes, mientras que la negligencia, la violencia física y la psicológica abarcan un rango etario más amplio, afectando tanto a jóvenes como a adultos. Esta información es fundamental para formular intervenciones y políticas de prevención enfocadas en los grupos más vulnerables, adaptando las estrategias de apoyo a las características de cada tipo de violencia y al grupo etario más afectado. A continuación, se presenta una tabla de contigencia que ilustra la distribución de los tipos de violencia de género según el ciclo de vida de las víctimas para observar cómo varían las incidencias de diferentes formas de violencia a lo largo de las distintas etapas de la vida, destacando las vulnerabilidades específicas que enfrentan los individuos.

```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(tidyr)
library(kableExtra)

violencia_genero$def_naturaleza <- as.factor(violencia_genero$def_naturaleza)

tabla_violencia <- violencia_genero %>%
  group_by(def_naturaleza, `Ciclo de vida`) %>%
  summarise(n = n(), .groups = 'drop') %>%
  arrange(def_naturaleza, `Ciclo de vida`)

tabla_ancha <- tabla_violencia %>%
  pivot_wider(id_cols = def_naturaleza, names_from = `Ciclo de vida`, values_from = n, values_fill = list(n = 0))

column_order <- c("def_naturaleza", "Primera infancia", "Infancia", "Adolescencia", "Juventud", "Adultez", "Persona Mayor")
tabla_ancha <- tabla_ancha %>%
  select(any_of(column_order))

names(tabla_ancha)[names(tabla_ancha) == "def_naturaleza"] <- "Tipos de Violencia"

tabla_ancha %>%
  kable("html", align = "c", digits = 0, 
        caption = "Frecuencia de Casos de Violencia por Tipos de Violencia y Etapas de Vida") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")



```

La tabla confirma que el tipo de violencia con mayor prevalencia en la mayoría de las etapas de vida es la Negligencia y Abandono, especialmente en la "Primera Infancia" con 2,773 casos. Sin embargo, también muestra una alta frecuencia en la "Adolescencia" (572 casos) y la "Juventud" (340 casos), lo que indica que los adolescentes y jóvenes también son considerablemente vulnerables a este tipo de violencia. La incidencia de negligencia y abandono disminuye en etapas de vida posteriores, pero aún se mantiene significativa en la "Persona Mayor" (171 casos). Este patrón sugiere que tanto los más jóvenes como los adolescentes y adultos mayores, quienes pueden tener mayores niveles de dependencia en su cuidado, están particularmente expuestos a este tipo de violencia.La Violencia Física muestra una frecuencia notablemente alta en la "Adultez" con 1,600 casos, seguida de la "Juventud" (1,300 casos) y la "Adolescencia" (445 casos). Estos datos indican que esta forma de violencia es especialmente prevalente en adultos y jóvenes, probablemente debido a factores de convivencia y conflictos interpersonales en etapas de mayor interacción social y laboral. La presencia significativa de violencia física en adolescentes también apunta a una posible vulnerabilidad en contextos familiares o escolares.

El Abuso Sexual presenta su mayor incidencia en la "Adolescencia" con 401 casos, lo que la posiciona como la etapa más crítica de riesgo para este tipo de violencia. La "Primera Infancia" es la segunda etapa de mayor prevalencia con 234 casos, seguida de la "Infancia" con 171 casos. Estos datos reflejan que el abuso sexual afecta principalmente a menores y adolescentes, quienes pueden estar en situaciones de poder desigual que los exponen a este tipo de agresión. Otros tipos de violencia sexual, como el "Acoso Sexual" y el "Acceso Carnal," también se concentran principalmente en la adolescencia. En cuanto a la Violencia Psicológica, la "Juventud" es la etapa con mayor prevalencia, con 163 casos, seguida de la "Adultez" (156 casos). Esto sugiere que la violencia psicológica es más común entre adultos jóvenes, probablemente debido a la naturaleza de las relaciones personales y laborales que caracterizan esta etapa, donde las interacciones y los conflictos emocionales pueden intensificarse.

Finalmente, es notable que ciertos tipos de violencia, como la Trata de Personas y la Explotación Sexual Comercial de Niños y Adolescentes, presentan frecuencias extremadamente bajas en todas las etapas, lo cual podría reflejar una menor incidencia de estos casos o, alternativamente, un subregistro debido a la dificultad de detección y denuncia de estas situaciones. En conclusión, la tabla muestra que la vulnerabilidad a diferentes tipos de violencia varía significativamente según la etapa de vida, con tipos de violencia específicos concentrándose en ciertos grupos: la negligencia en los más jóvenes y en adolescentes, la violencia física en adultos y jóvenes, el abuso sexual en adolescentes y niños, y la violencia psicológica en jóvenes adultos. Esta información es fundamental para orientar intervenciones específicas y políticas de protección dirigidas a los grupos más vulnerables. Lo anterior, se puede evidenciar de manera más clara en la gráfica posterior, la cual ilustra los 3 tipos de violencia con mayores casos y sus frecuencias por ciclo de vida asociados: 

```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(ggplot2)

tabla_violencia_ciclo <- violencia_genero %>%
  group_by(def_naturaleza, `Ciclo de vida`) %>%
  summarise(n = n(), .groups = 'drop') %>%
  arrange(desc(n))

top_3_violencias <- tabla_violencia_ciclo %>%
  group_by(def_naturaleza) %>%
  summarise(total = sum(n)) %>%
  arrange(desc(total)) %>%
  head(3) %>%
  pull(def_naturaleza)

tabla_filtrada <- tabla_violencia_ciclo %>%
  filter(def_naturaleza %in% top_3_violencias)

tabla_filtrada$`Ciclo de vida` <- factor(tabla_filtrada$`Ciclo de vida`, 
                                          levels = c("Primera infancia", "Infancia", "Adolescencia", 
                                                     "Juventud", "Adultez", "Persona Mayor"))

ggplot(tabla_filtrada, aes(x = reorder(def_naturaleza, n), y = n, fill = `Ciclo de vida`)) +
  geom_bar(stat = "identity", position = "dodge", width = 0.8) +
  geom_text(aes(label = n), position = position_dodge(width = 0.8), vjust = 0.5, hjust = -0.1, color = "black", size = 4) +
  labs(title = "Frecuencia de los Tres Tipos de\nViolencia con Más Casos por Ciclo de Vida",
       x = "Tipo de Violencia",
       y = "Casos Registrados") +
  theme_classic() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16, vjust = 2),
    axis.title.x = element_text(face = "bold", size = 12),
    axis.title.y = element_text(face = "bold", size = 12),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.line = element_line(color = "gray50", size = 0.5),
    panel.grid.major.x = element_line(color = "gray80", size = 0.3),
    panel.grid.minor = element_blank(),
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)), limits = c(0, 4000)) +
  scale_fill_brewer(palette = "Blues") +
  coord_flip()



```

A partir de esta visualización de la distribución de los casos registrados en los 3 tipos de violencia de género más recurrentes en los años de estudio, podemos calcular probabilidades condicionales, como se muestra en la tabla inferior, para comprender la factibilidad de que la víctima experimiente cierto tipo de violencia dado que está en cierto ciclo de vida. Como se puede observar, para el caso de Negligencia y Abandono, vemos que la probabilidad más alta de ser víctima ocurre en la Primera Infancia, con un 75.21%. Esto refleja la dependencia crítica de los niños pequeños hacia sus cuidadores, lo que los convierte en un grupo altamente vulnerable a la negligencia. A medida que se avanza en el ciclo de vida, esta probabilidad disminuye, con un 50.65% en la Infancia y un 25.39% en la Adolescencia, alcanzando su punto más bajo en la Adultez con un 5.48%. Sin embargo, en la Persona Mayor, la probabilidad aumenta nuevamente a un 46.22%, lo que indica que la negligencia no solo es un suceso común en la infancia, sino también en las personas mayores, posiblemente debido a factores de dependencia y vulnerabilidad física o social. 

En el caso del Abuso Sexual, el patrón es diferente. En la Primera Infancia, la probabilidad es de solo un 6.35%, pero aumenta en la Infancia a 11.13%, lo que refleja la prevalencia de este tipo de violencia en los niños pequeños. Lo más destacado, sin embargo, es que el pico más alto de abuso sexual ocurre en la Adolescencia, con un 17.87%. Esto subraya que los adolescentes son el grupo más afectado por el abuso sexual, mostrando que la vulnerabilidad a este tipo de violencia es particularmente alta durante esta etapa de la vida. A partir de la Juventud y en las etapas de Adultez y Persona Mayor, las probabilidades disminuyen considerablemente (14.77%, 1.27% y 0.81%, respectivamente), lo que sugiere que el abuso sexual es mucho menos frecuente en adultos y personas mayores, con una clara concentración en la niñez y adolescencia.

Finalmente, la Violencia Física presenta un patrón distinto. En la Primera Infancia, la probabilidad es de 9.06%, pero comienza a aumentar en la Infancia (12.89%) y Adolescencia (19.75%). Sin embargo, el pico más alto de violencia física se alcanza en la Adultez, con una probabilidad del 78.24%, lo que refleja que los adultos son los más afectados por este tipo de violencia, posiblemente debido a factores sociales y laborales que afectan las dinámicas familiares y personales. En la Persona Mayor, la probabilidad disminuye a 40.81%, aunque sigue siendo significativa, lo que indica que, aunque es menos prevalente que en la juventud y adultez, la violencia física sigue siendo un problema en las etapas posteriores de la vida.

En resumen, el análisis de las probabilidades de cada tipo de violencia según la etapa de vida de las víctimas revela patrones importantes. La negligencia y abandono afecta principalmente a los extremos del ciclo de vida (niños pequeños y adultos mayores), el abuso sexual es más prevalente en los adolescentes, y la violencia física tiene su mayor incidencia en la Adultez, con un alto nivel también en la Juventud. Estos patrones nos permiten entender mejor la distribución de estos sucesos y enfocarnos en las etapas del ciclo de vida que requieren más atención en términos de prevención y políticas de protección, adaptadas a los riesgos específicos de cada grupo etario.

```{r,echo=FALSE,warning=FALSE, message=FALSE}
library(dplyr)
library(DT)

ciclos_de_vida_ordenados <- c("Primera infancia", "Infancia", "Adolescencia", "Juventud", "Adultez", "Persona Mayor")

tipos_de_violencia_seleccionados <- c("Violencia física", "Abuso sexual", "Negligencia y abandono")

tabla_conteo_violencia_etapa <- violencia_genero %>%
  filter(def_naturaleza %in% tipos_de_violencia_seleccionados) %>%
  group_by(`Ciclo de vida`, def_naturaleza) %>%
  summarise(casos = n(), .groups = 'drop')

total_ciclo_vida <- violencia_genero %>%
  group_by(`Ciclo de vida`) %>%
  summarise(total = n(), .groups = 'drop')

tabla_probabilidades_violencia <- tabla_conteo_violencia_etapa %>%
  left_join(total_ciclo_vida, by = "Ciclo de vida") %>%
  mutate(
    probabilidad = round(casos / total, 4),
    porcentaje = paste0(round(probabilidad * 100, 2), "%"),
    enunciado = paste0("P(<b><i><sub>", def_naturaleza, "</sub></i></b> | <b><i><sub>", `Ciclo de vida`, "</sub></i></b>)")
  ) %>%
  arrange(factor(`Ciclo de vida`, levels = ciclos_de_vida_ordenados)) %>%
  select(enunciado, probabilidad, porcentaje)

datatable(tabla_probabilidades_violencia, 
          colnames = c("Enunciado", "Probabilidad", "Porcentaje"),
          caption = "Probabilidad de ser Víctima de un Tipo de Violencia dado el Ciclo de Vida",
          escape = FALSE,
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")), 
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("probabilidad"), digits = 2)



```

## Análisis general de casos de violencia por género de las Víctimas

Este apartado presenta un análisis descriptivo estadístico de los casos de violencia por género, con el objetivo de identificar la distribución de las víctimas según su género y explorar cómo este factor se relaciona con los distintos tipos de violencia. Se analizará la cantidad de víctimas por género y qué género es más afectado por cada tipo de violencia. Este análisis es fundamental para comprender las tendencias y características de la violencia de género, lo que facilita la creación de estrategias de intervención específicas y basadas en datos, dirigidas a reducir y prevenir la violencia de manera más efectiva.


### Análisis inicial de número de víctimas registradas de violencia por género

```{r,echo=FALSE,warning=FALSE}
gender_count <- table(violencia_genero$sexo_victima)
percentages <- round(gender_count / sum(gender_count) * 100, 1)
labels <- paste(names(gender_count), "\n", gender_count, " (", percentages, "%)", sep = "")
colors <- c("lightblue", "blue")

par(mar = c(1, 2, 2, 1))  
pie(gender_count, labels = labels, col = colors, main = "Distribución de Mujeres y Hombres Registrados", 
    border = "black", clockwise = TRUE, init.angle = 90)

```

La gráfica muestra la distribución de mujeres y hombres registrados en los casos de violencia de género en Colombia, con los mujeres representando el 69.1% de los casos, mientras que los hombres constituyen el 30.9%. Este patrón refleja una prevalencia significativa de víctimas femeninas en los incidentes de violencia de género, lo cual es consistente con las estadísticas globales y nacionales que muestran que las mujeres, especialmente en contextos de violencia doméstica y sexual, son más vulnerables a estos abusos. Este análisis resalta la necesidad urgente de abordar la violencia de género de manera diferenciada según el género, con un enfoque especial en las mujeres, que en este caso representan casi el 70% de las víctimas. Además, aunque la proporción de hombres víctimas es menor, su presencia no debe ser ignorada, ya que también pueden enfrentar formas de violencia de género, aunque frecuentemente es menos reportado o reconocido en contextos sociales. Esto subraya la importancia de mejorar la recolección de datos y la visibilidad de los hombres como víctimas, especialmente en situaciones de violencia psicológica o en relaciones abusivas.


### Número de casos por tipo de violencia correspondiente a cada género

```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(ggplot2)

tabla_violencia_genero <- violencia_genero %>%
  group_by(def_naturaleza, sexo_victima) %>%
  summarise(n = n(), .groups = 'drop') %>%
  arrange(desc(n))

ggplot(tabla_violencia_genero, aes(x = reorder(def_naturaleza, n), y = n, fill = sexo_victima)) +
  geom_bar(stat = "identity", position = "dodge", width = 0.8) +
  geom_text(aes(label = n), position = position_dodge(width = 1), vjust = 0.5, hjust = -0.1, color = "black", size = 2.6) +
  labs(title = "Frecuencia de Casos de Violencia\npor Género y Tipo de Violencia",
       x = "Tipo de Violencia",
       y = "Casos Registrados") +
  theme_classic() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16, vjust = 2),
    axis.title.x = element_text(face = "bold", size = 12),
    axis.title.y = element_text(face = "bold", size = 12),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.line = element_line(color = "gray50", size = 0.5),
    panel.grid.major.x = element_line(color = "gray80", size = 0.3),
    panel.grid.minor = element_blank(),
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)), limits = c(0, 4000)) +
  scale_fill_manual(values = c("steelblue", "lightblue"), name = "Sexo Víctimas") +
  coord_flip()


```

La gráfica muestra que en el tipo de "Violencia física," las mujeres son las principales víctimas, con un total de 3,100 casos, mientras que en hombres la cifra es de 928 casos, lo cual resalta una disparidad significativa en la victimización de las mujeres en este tipo de violencia. En "Abuso sexual," se observa una tendencia similar, con 834 casos en mujeres frente a solo 119 en hombres, lo cual confirma que este tipo de violencia impacta de manera mucho más pronunciada al género femenino. Además, en "Violencia psicológica," las mujeres también presentan un número mayor de casos, alcanzando los 449, mientras que los hombres registran solo 95 casos. Estos datos reflejan un patrón en el que las mujeres son desproporcionadamente más afectadas por las formas de violencia física, sexual y psicológica.

Por otro lado, en el caso de "Negligencia y abandono," la distribución entre géneros es más equilibrada, con 2,410 casos en mujeres y 2,338 en hombres, lo cual sugiere que esta forma de violencia no está tan marcada por el género de la víctima. En "Acoso sexual," las cifras vuelven a mostrar una diferencia notable, con 248 casos en mujeres frente a 39 en hombres, reafirmando que las agresiones de índole sexual afectan principalmente a las mujeres. Es importante también mencionar la categoría "Sin información," que cuenta con 539 casos, indicando una falta de detalle en la documentación que podría estar limitando la comprensión completa de la dinámica de género en la victimización. 

Si traducimos lo anterior a términos probabilísticos, considerando la etapa de vida de las víctimas, su sexo y los tres tipos de violencia de género más reportados, podemos obtener los siguientes hallazgos: 

```{r,echo=FALSE,warning=FALSE,message=FALSE}

library(dplyr)
library(DT)

tipos_principales <- c("Negligencia y abandono", "Violencia física", "Abuso sexual")
ciclos_de_vida_ordenados <- c("Primera infancia", "Infancia", "Adolescencia", "Juventud", "Adultez", "Persona Mayor")

data_filtrada <- subset(violencia_genero, def_naturaleza %in% tipos_principales)

tabla_conteo <- data_filtrada %>%
  group_by(sexo_victima, `Ciclo de vida`, def_naturaleza) %>%
  summarise(casos = n()) %>%
  ungroup()

total_ciclo_genero <- data_filtrada %>%
  group_by(sexo_victima, `Ciclo de vida`) %>%
  summarise(total = n()) %>%
  ungroup()

tabla_probabilidades <- tabla_conteo %>%
  left_join(total_ciclo_genero, by = c("sexo_victima", "Ciclo de vida")) %>%
  mutate(probabilidad = round(casos / total, 4),
         porcentaje = paste0(round(probabilidad * 100, 2), "%"),
         enunciado = paste0("P(", def_naturaleza, " | ", sexo_victima, " ∩ ", `Ciclo de vida`, ")")) %>%
  arrange(factor(def_naturaleza, levels = tipos_principales), 
          factor(`Ciclo de vida`, levels = ciclos_de_vida_ordenados)) %>% 
  select(enunciado, probabilidad, porcentaje)

datatable(tabla_probabilidades, 
          colnames = c("Enunciado", "Probabilidad", "Porcentaje"),
          caption = "Probabilidades Condicionales de Ser Víctima de un Tipo de Violencia por Ciclo de Vida",
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")), 
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("probabilidad"), digits = 2)


```

Como se evidencia, en particular, la probabilidad más alta en la tabla corresponde a hombres en la etapa de "Persona Mayor" para "Violencia Física", con un valor de 92.96%. Este dato indica que, en esta combinación específica, la probabilidad condicional de que un hombre mayor sufra violencia física es extremadamente alta en comparación con otros grupos. Del mismo modo, las mujeres en la etapa de "Juventud" presentan una probabilidad significativa del 72.51% para el mismo tipo de violencia, lo que señala que esta etapa es también un periodo de alta vulnerabilidad para el género femenino en términos de violencia física. Estos valores destacan eventos altamente probables y sugieren que tanto los hombres mayores como las mujeres jóvenes son grupos particularmente propensos a este tipo de agresión, haciendo que la violencia física sea un evento dependiente de género y edad.

Por otro lado, los grupos con las probabilidades más bajas también revelan patrones importantes. Por ejemplo, la probabilidad de que una persona mayor, tanto hombre (0.78%) como mujer (1.02%), sufra "Abuso Sexual" es baja. Estos eventos de baja probabilidad indican que este tipo de violencia es relativamente poco frecuente en las etapas de vida más avanzadas, lo que podría estar relacionado con factores como la menor exposición o una disminución en la vulnerabilidad percibida por los agresores hacia este grupo. En otro extremo, encontramos que la "Negligencia y Abandono" es un suceso probable en etapas tempranas y avanzadas de la vida para ambos géneros, especialmente en la "Primera Infancia" para hombres, con una probabilidad de 87.41%, y en "Persona Mayor" para mujeres (47.72%).

## Análisis de la mortalidad de la víctima en los casos registrados

En este apartado, se analiza la mortalidad de las víctimas en casos de violencia de género, considerando cómo el género, el ciclo de vida y el tipo de violencia influyen en el desenlace fatal. Este enfoque permite identificar patrones de riesgo específicos y comprender mejor la vulnerabilidad de ciertos grupos, proporcionando una visión crítica sobre los factores que agravan las consecuencias de la violencia de género.

### Contexto general de mortalidad de las víctimas de caso de violencia

```{r,echo=FALSE,warning=FALSE}
mortalidad_count <- table(violencia_genero$con_fin_)

percentages <- round(mortalidad_count / sum(mortalidad_count) * 100, 1)

labels <- paste(names(mortalidad_count), "\n", mortalidad_count, " (", percentages, "%)", sep = "")

colors <- c("lightblue", "blue", "gray")

par(mar = c(1, 2, 2, 1))  
pie(mortalidad_count, labels = labels, col = colors, main = "Distribución de Víctimas Mortales, No Mortales y Desconocidos", 
    border = "black", clockwise = TRUE, init.angle = 90)

```

La gráfica muestra la distribución de víctimas de violencia de género en tres categorías: vivas, muertas y desconocidas. La mayor proporción corresponde a víctimas vivas, representando el 46.2% del total (5,639 casos). Esto indica que casi la mitad de los casos de violencia de género no resultaron en mortalidad, lo que sugiere una alta prevalencia de violencia de género que, aunque no lleva a la muerte, sigue teniendo un impacto significativo en las víctimas.Por otro lado, un 24.5% (2,986 casos) corresponde a víctimas que fallecieron, lo que resalta una proporción considerable de mortalidad asociada a la violencia de género. Esto evidencia la gravedad de ciertos casos y destaca la letalidad potencial de esta forma de violencia. Además, un 29.3% de los casos (3,568) se clasifica como "desconocido," lo que indica una falta de información sobre el estado final de muchas víctimas. En resumen, la mayoría de las víctimas de violencia de género sobreviven, pero una proporción significativa fallece, mientras que casi un tercio de los casos carece de información sobre el estado final, lo que limita el análisis completo de la situación.

### Mortalidad de las víctimas de casos de violencia por género

```{r,echo=FALSE,warning=FALSE}
mortalidad_femenino <- table(violencia_genero$con_fin_[violencia_genero$sexo_victima == "Femenino"])
mortalidad_masculino <- table(violencia_genero$con_fin_[violencia_genero$sexo_victima == "Masculino"])

percentages_femenino <- round(mortalidad_femenino / sum(mortalidad_femenino) * 100, 1)
labels_femenino <- paste(names(mortalidad_femenino), "\n", mortalidad_femenino, " (", percentages_femenino, "%)", sep = "")

percentages_masculino <- round(mortalidad_masculino / sum(mortalidad_masculino) * 100, 1)
labels_masculino <- paste(names(mortalidad_masculino), "\n", mortalidad_masculino, " (", percentages_masculino, "%)", sep = "")

colors <- c("lightblue", "blue", "gray")

par(mfrow = c(1, 2), mar = c(2, 2, 1, 4), oma = c(0.5, 1, 1, 1))

pie(mortalidad_femenino, labels = labels_femenino, col = colors, 
    border = "black", clockwise = TRUE, init.angle = 90)
mtext("Distribución en Femenino", side = 3, line = -2, cex = 1.2, font = 2)

pie(mortalidad_masculino, labels = labels_masculino, col = colors, 
    border = "black", clockwise = TRUE, init.angle = 90)
mtext("Distribución en Masculino", side = 3, line = -2, cex = 1.2, font = 2)


```

La gráfica muestra la distribución de la mortalidad de las víctimas de violencia de género desglosada por género y revela que la mortalidad es mayor en mujeres que en hombres, tanto en términos relativos como absolutos. En el caso de las mujeres, el 23.4% (1,973 casos) de las víctimas falleció, mientras que el 46.9% (3,951 casos) sobrevivió y un 29.7% (2,499 casos) se clasifica como "desconocido". Para los hombres, el 26.9% (1,013 casos) de las víctimas falleció, mientras que el 44.8% (1,688 casos) sobrevivió y el 28.4% (1,069 casos) corresponde a la categoría de "desconocido". Aunque el porcentaje de mortalidad en relación con los hombres también es considerable, la cantidad absoluta de mujeres fallecidas es notablemente mayor, evidenciando que la violencia de género resulta en una mayor letalidad para las mujeres.

En cuanto a los sobrevivientes, se observa que tanto en hombres como en mujeres, la proporción de quienes sobreviven a estos episodios de violencia es significativa, aunque levemente mayor en las mujeres (46.9% frente a 44.8% en hombres). Este dato sugiere que, aunque la letalidad es alta, existe una considerable cantidad de víctimas que logran sobrevivir. Sin embargo, este alto porcentaje de sobrevivientes también implica una potencial carga emocional, física y social prolongada para estas personas, quienes pueden enfrentar consecuencias duraderas debido a la violencia experimentada. La significativa proporción de casos "desconocidos" limita el análisis completo del impacto de la violencia en términos de supervivencia y mortalidad, subrayando la importancia de un registro más detallado.


### Mortalidad de las víctimas de casos de violencia por ciclo de vida


```{r,echo=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)

violencia_genero$`Ciclo de vida` <- factor(violencia_genero$`Ciclo de vida`, 
                                           levels = c("Primera infancia", "Infancia", "Adolescencia", "Juventud", "Adultez", "Persona Mayor"))

datos_agrupados_mortalidad <- violencia_genero %>%
  group_by(`Ciclo de vida`, con_fin_) %>%
  summarise(Conteo = n(), .groups = 'drop')

ggplot(datos_agrupados_mortalidad, aes(x = `Ciclo de vida`, y = Conteo, fill = con_fin_)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
  geom_text(aes(label = Conteo), vjust = -0.3, position = position_dodge(width = 0.9), size = 3) +
  scale_fill_manual(values = c("#1f78b4", "#6baed6", "#a6cee3")) +
  scale_y_continuous(limits = c(0, 1700), breaks = seq(0, 1700, by = 200), expand = c(0, 0)) +  
  labs(
    title = "Distribución de Mortalidad por Ciclo de Vida",
    x = "Ciclo de Vida",
    y = "Número de Casos",
    fill = "Mortalidad"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank(),
    axis.line.x = element_line(color = "black"),
    axis.line.y = element_line(color = "black"),
    plot.title = element_text(hjust = 0.5, face = "bold")
  )



```

Se puede observar cómo la violencia de género afecta de manera distinta a cada grupo etario. En la Primera Infancia, se registran 1,586 víctimas en estado "vivo", 1,141 fallecidas y 960 en estado "desconocido". La elevada cantidad de fallecimientos en este grupo subraya su alta vulnerabilidad frente a la violencia de género, probablemente debido a su dependencia y limitada capacidad de defensa. Este grupo enfrenta un riesgo significativo de sufrir consecuencias graves, y el número considerable de casos "desconocidos" indica posibles deficiencias en los reportes, lo cual podría dificultar la identificación precisa de los factores de riesgo. En la Juventud y Adolescencia, también se observa una notable cantidad de víctimas vivas y fallecidas. La juventud destaca por presentar una mayor proporción de sobrevivientes, lo cual podría estar vinculado a mejores oportunidades de recibir atención oportuna y mayor capacidad para reportar incidentes de violencia. Sin embargo, la probabilidad de mortalidad en ambas etapas es significativa, lo que indica que los adolescentes y jóvenes enfrentan riesgos considerables de violencia con graves consecuencias. La alta incidencia en estas etapas sugiere una exposición sostenida a la violencia, posiblemente relacionada con factores como las dinámicas sociales y familiares en esta fase de la vida.

En la Adultez, aunque se observa una menor mortalidad en comparación con las etapas más tempranas, el riesgo de fallecimiento continúa siendo alto. Esto podría interpretarse como una mayor capacidad de defensa o de denuncia en los adultos, pero al mismo tiempo resalta que la violencia de género sigue teniendo consecuencias graves en esta etapa de la vida. Finalmente, el grupo de Personas Mayores muestra una incidencia menor de casos de violencia, con una proporción considerable de desconocidos, lo cual podría indicar tanto una menor exposición como una posible subestimación en los reportes. La probabilidad de mortalidad sigue siendo relevante en este grupo, posiblemente debido a factores de salud y a una menor capacidad de resistencia frente a la violencia. En resumen, el análisis sugiere que la violencia de género afecta de manera desproporcionada a los más jóvenes, especialmente en la primera infancia, donde el riesgo de mortalidad es elevado. La adolescencia y juventud también muestran una alta exposición y riesgo, mientras que la adultez y la vejez presentan menor incidencia, aunque con una mortalidad significativa. La presencia de casos "desconocidos" en todos los grupos destaca la necesidad de mejorar la calidad del registro de datos para una comprensión más completa del impacto de la violencia a lo largo del ciclo de vida. 

### Mortalidad de las víctimas de caso de violencia por tipo de violencia de género


```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(tidyr)
library(kableExtra)

column_order_tipo <- c("Vivo", "Muerto", "Desconocido")

tabla_ancha_tipo <- violencia_genero %>%
  count(def_naturaleza, con_fin_) %>%
  pivot_wider(names_from = con_fin_, values_from = n, values_fill = list(n = 0)) %>%
  select(def_naturaleza, all_of(column_order_tipo))

names(tabla_ancha_tipo)[names(tabla_ancha_tipo) == "def_naturaleza"] <- "Tipos de Violencia"

tabla_ancha_tipo %>%
  kable("html", align = "c", digits = 0, 
        caption = "Frecuencia de Casos de Violencia por Tipos de Violencia y Estado de la Víctima") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")



```

La tabla presenta la distribución de casos de violencia de género clasificados por tipo de violencia y el estado de las víctimas (vivo, muerto, desconocido). Este análisis permite observar cómo la gravedad de los incidentes y sus desenlaces pueden variar según el tipo de violencia, mostrando ciertos patrones en términos de supervivencia y mortalidad. Violencia física es el tipo de violencia con la mayor cantidad de casos en estado "vivo," con 2,255 víctimas, seguido de 1,516 casos de mortalidad y 616 con estado "desconocido." Esto indica que, aunque muchos sobreviven a la violencia física, esta también representa un riesgo significativo de mortalidad. Este patrón refleja la naturaleza potencialmente letal de la violencia física, con un notable número de casos en los tres estados.

Negligencia y abandono también presenta cifras elevadas en todas las categorías, con 1,945 casos en estado "vivo" y 1,606 en estado "muerto," además de un número considerable de casos con estado "desconocido" (1,195). Este tipo de violencia parece tener un impacto particularmente grave, dado que la proporción de fallecimientos es alta, lo que sugiere una falta de cuidados básicos que en muchos casos resulta fatal. En el caso de abuso sexual, se registran 411 víctimas en estado "vivo" y 309 fallecimientos, mientras que 233 casos se encuentran en estado "desconocido." La notable cantidad de fallecimientos en casos de abuso sexual destaca los riesgos letales asociados a esta forma de violencia, especialmente para las víctimas más vulnerables. Otros tipos de violencia sexual, como acoso sexual y actos sexuales, también presentan un número relevante de víctimas fallecidas y desconocidas, lo que enfatiza la peligrosidad de estos tipos de abuso.

Tipos de violencia con una menor frecuencia, como otras violencias sexuales y otros actos sexuales, aunque en menor cantidad total, siguen mostrando un patrón de casos en estado "vivo" y "muerto." Es importante destacar que, aunque los números absolutos son más bajos, la presencia de casos en todas las categorías (vivo, muerto y desconocido) subraya la seriedad de cualquier tipo de violencia de género, independientemente de su frecuencia. La categoría de sin información es notable, con 275 casos en estado "vivo," 207 en "muerto" y 146 en "desconocido." Esto sugiere posibles dificultades en la clasificación o el seguimiento de los casos, limitando el análisis completo de sus desenlaces.

En resumen, la tabla revela que la violencia física y la negligencia y abandono son los tipos de violencia más letales, con altos números de víctimas fallecidas. La violencia sexual, especialmente el abuso sexual, también tiene una elevada tasa de mortalidad. Esta distribución evidencia la variabilidad en las consecuencias de la violencia de género según el tipo, destacando la necesidad de enfoques específicos para prevenir y atender las distintas formas de violencia en función de su impacto en la supervivencia y el estado de las víctimas.

A continuación, se presentan las probabilidades condicionales de mortalidad dado el sexo de la víctima y el tipo de violencia experimentado, teniendo en consideración los tres principales casos de violencia de género reportados:

```{r,echo=FALSE, warning=FALSE,message=FALSE}
library(dplyr)
library(DT)

tipos_principales_vi <- c("Negligencia y abandono", "Violencia física", "Abuso sexual")

data_filtrada_vi <- violencia_genero %>%
  filter(def_naturaleza %in% tipos_principales_vi)

total_sexo_violencia_vi <- data_filtrada_vi %>%
  group_by(sexo_victima, def_naturaleza) %>%
  summarise(total = n()) %>%
  ungroup()

tabla_probabilidades_vi <- data_filtrada_vi %>%
  group_by(sexo_victima, def_naturaleza, con_fin_) %>%
  summarise(casos = n()) %>%
  ungroup() %>%
  left_join(total_sexo_violencia_vi, by = c("sexo_victima", "def_naturaleza")) %>%
  mutate(probabilidad = round(casos / total, 4),
         porcentaje = paste0(round(probabilidad * 100, 2), "%"),
         enunciado = paste0("P(", con_fin_, " | ", sexo_victima, " ∩ ", def_naturaleza, ")")) %>%
  arrange(factor(def_naturaleza, levels = tipos_principales_vi)) %>%
  select(enunciado, probabilidad, porcentaje)

datatable(tabla_probabilidades_vi, 
          colnames = c("Enunciado", "Probabilidad", "Porcentaje"),
          caption = "Probabilidades Condicionales de Mortalidad por Sexo y Tipo de Violencia",
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")), 
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("probabilidad"), digits = 2)

```

Como se evidencia, para los casos de "Negligencia y Abandono," la probabilidad condicional de que una mujer sobreviva, dado que ha sido víctima de este tipo de violencia, es del 41%, mientras que la probabilidad de que fallezca es del 34%. Estas probabilidades sugieren una considerable exposición a desenlaces graves para las mujeres en situaciones de negligencia. En el caso de los hombres, observamos una probabilidad similar de supervivencia del 40.97% y una probabilidad de fallecimiento del 33.6%. Esto indica que ambos géneros tienen probabilidades comparables de un desenlace fatal cuando el evento de violencia es de tipo negligencia y abandono.

En el contexto de "Violencia Física," las probabilidades de supervivencia son notablemente altas en ambos géneros. La probabilidad condicional de supervivencia para mujeres víctimas de violencia física es del 55.81%, mientras que la probabilidad de fallecimiento es mucho menor, alcanzando solo un 6.32%. Para los hombres, esta relación se mantiene, con una probabilidad de supervivencia del 56.57% y de fallecimiento del 6.57%. Este patrón probabilístico refleja que, aunque la violencia física tiene consecuencias severas, la mayoría de las víctimas, independientemente de su género, tienen una mayor probabilidad de sobrevivir, lo que podría estar relacionado con intervenciones oportunas.

Por otro lado, en casos de "Abuso Sexual," la probabilidad de que una mujer sobreviva es del 42.45%, mientras que la probabilidad de fallecimiento se eleva a un 33.21%, destacando una mayor vulnerabilidad ante desenlaces fatales en situaciones de abuso sexual. Para los hombres, la probabilidad de supervivencia es de 47.9%, con una probabilidad de fallecimiento del 26.89%. Estas probabilidades sugieren que ambos géneros están expuestos a riesgos significativos en casos de abuso sexual, aunque la probabilidad de un desenlace fatal es ligeramente menor para los hombres en comparación con las mujeres.

En general, este análisis de probabilidades condicionales evidencia que cada tipo de violencia conlleva distintos riesgos de mortalidad, variando por género. Las probabilidades de desenlaces letales son más altas en casos de negligencia y abuso sexual, mientras que la violencia física presenta mayores probabilidades de supervivencia. Este enfoque probabilístico proporciona una visión crítica sobre los patrones de riesgo y permite identificar los tipos de violencia que representan una mayor amenaza para la vida, contribuyendo a la formulación de estrategias de intervención y prevención más específicas y efectivas para los grupos en mayor riesgo.

## Análisis general de presencia de casos de violencia de género por departamento, escenario y estrato de la víctima

En este apartado se presenta un análisis general de la presencia de casos de violencia de género, considerando tres dimensiones clave: el departamento, el escenario en el que ocurrieron los incidentes y el estrato socioeconómico de las víctimas. Este enfoque permite identificar patrones geográficos, contextuales y económicos en la incidencia de la violencia de género, proporcionando una comprensión más detallada de los factores de riesgo y de vulnerabilidad en distintas áreas y contextos. A través de este análisis, se busca establecer las bases para futuras intervenciones y políticas públicas enfocadas en reducir la violencia de género en los grupos y espacios más afectados.

###  Número de casos de violencia de género registrados por departamento

```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(DT)

tipos_principales <- c("Negligencia y abandono", "Violencia física", "Abuso sexual")

data_filtrada <- subset(violencia_genero, def_naturaleza %in% tipos_principales)

tabla_conteo <- data_filtrada %>%
  group_by(Departamento) %>%
  summarise(casos = n()) %>%
  ungroup()

total_casos <- sum(tabla_conteo$casos)

tabla_conteo <- tabla_conteo %>%
  mutate(proporcion = round(casos / total_casos, 4),
         porcentaje = paste0(round(proporcion * 100, 2), "%"))

datatable(tabla_conteo, 
          colnames = c("Departamento", "Número de Casos", "Proporción", "Porcentaje"),
          caption = "Número de Casos Registrados por Departamento, Proporción y Porcentaje",
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")),
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("proporcion"), digits = 4)


```

La tabla muestra el número de casos registrados desglosado por departamento, junto con la proporción y el porcentaje que representa cada uno respecto al total de casos. Este desglose permite identificar patrones geográficos en la incidencia de los casos y observar cuáles departamentos presentan una carga más significativa en relación con el fenómeno en estudio. En primer lugar, destacan los departamentos de Cundinamarca, Valle del Cauca y Antioquia, que presentan las cifras absolutas más altas. Cundinamarca lidera con 500 casos, lo cual representa un 5.14% del total, seguido por el Valle del Cauca con 424 casos (4.36%) y Antioquia con 392 casos (4.03%). La alta incidencia en estos departamentos podría estar influenciada por factores como una mayor densidad poblacional o un sistema más desarrollado para reportar y registrar incidentes, lo que facilita la visibilización de estos casos. Estos valores sugieren que estas áreas son focos importantes de atención, ya que agrupan un porcentaje significativo del total de casos registrados.

A nivel de proporciones y porcentajes, observamos que la mayoría de los departamentos se encuentran en un rango entre el 2% y el 4% del total de casos. Por ejemplo, departamentos como Guaviare y Huila tienen proporciones de 3.71% y 3.4%, respectivamente. Esta dispersión indica que el fenómeno no está centralizado en una sola región, sino que tiene presencia en diversas áreas del país, lo cual sugiere que el problema es de carácter nacional. Esta distribución porcentual relativamente homogénea también apunta a que, aunque algunos departamentos tienen mayores números absolutos de casos, otros mantienen una proporción considerable cuando se compara con el total, haciendo que su incidencia relativa sea relevante.

En contraste, algunos departamentos muestran una menor incidencia de casos, tanto en términos absolutos como relativos. San Andrés y Providencia presenta uno de los registros más bajos, con solo 165 casos, lo cual representa un 1.7% del total. Otros departamentos como Cesar (1.63%) y Vichada (2.17%) también registran cifras bajas. Esto podría estar relacionado con menor población o acceso limitado a servicios de denuncia, lo que podría reducir la visibilidad de los casos en estas áreas y generar un subregistro.

En conclusión, la tabla resalta tanto los focos de mayor incidencia como las áreas con menor número de casos, brindando una visión completa de la distribución del fenómeno a nivel nacional. Los departamentos con porcentajes más altos, como Cundinamarca, Valle del Cauca y Antioquia, podrían requerir una asignación de recursos más significativa para la intervención y prevención. Sin embargo, la presencia de casos en casi todas las regiones confirma la naturaleza dispersa del fenómeno y la necesidad de políticas de atención integral que respondan a las particularidades de cada región.

A continuación, se presentan los casos reportados por tipo de violencia en cada departamento para darle mayor profundidad al análisis:

```{r,echo=FALSE,warning=FALSE,include=FALSE}

options(repos = c(CRAN = "https://cloud.r-project.org"))

if (!requireNamespace("leaflet", quietly = TRUE)) install.packages("leaflet")
if (!requireNamespace("readxl", quietly = TRUE)) install.packages("readxl")
if (!requireNamespace("sf", quietly = TRUE)) install.packages("sf")
if (!requireNamespace("dplyr", quietly = TRUE)) install.packages("dplyr")

library(leaflet)
library(readxl)
library(sf)
library(dplyr)

datos_departamentos <- read_xlsx("Frecuencia_def_naturaleza_por_Departamento_con_Total.xlsx")
geojson_url <- "https://gist.githubusercontent.com/john-guerra/43c7656821069d00dcbc/raw/be6a6e239cd5b5b803c6e7c2ec405b793a9064dd/Colombia.geo.json"
departamentos <- st_read(geojson_url)

datos_departamentos$Departamento <- toupper(datos_departamentos$Departamento)
departamentos$NOMBRE_DPT <- toupper(departamentos$NOMBRE_DPT)

datos_unidos <- departamentos %>%
  left_join(datos_departamentos, by = c("NOMBRE_DPT" = "Departamento"))

paleta_colores <- colorNumeric(
  palette = "GnBu",
  domain = datos_unidos$Total_casos
)

mapa <- leaflet(data = datos_unidos) %>%
  addProviderTiles(providers$CartoDB.Positron) %>%
  setView(lng = -74.2973, lat = 4.5709, zoom = 6) %>%
  addPolygons(
    fillColor = ~paleta_colores(Total_casos),
    weight = 2,
    opacity = 1,
    color = 'black',
    dashArray = '3',
    fillOpacity = 0.7,
    highlightOptions = highlightOptions(
      weight = 5,
      color = '#666',
      dashArray = '',
      fillOpacity = 0.7,
      bringToFront = TRUE
    ),
    popup = ~paste(
      "<b>Departamento:</b> ", NOMBRE_DPT, "<br>",
      "<b>Total de casos:</b> ", Total_casos, "<br>",
      "<table>",
      "<tr><td><b>Abuso sexual:</b> ", `Abuso sexual`, "</td></tr>",
      "<tr><td><b>Acceso carnal:</b> ", `Acceso carnal`, "</td></tr>",
      "<tr><td><b>Acoso sexual:</b> ", `Acoso sexual`, "</td></tr>",
      "<tr><td><b>Actos sexuales:</b> ", `Actos sexuales`, "</td></tr>",
      "<tr><td><b>Actos sexuales de violencia:</b> ", `Actos sexuales de violencia`, "</td></tr>",
      "<tr><td><b>Desconocida:</b> ", Desconocida, "</td></tr>",
      "<tr><td><b>Explotación sexual comercial:</b> ", `Explotación sexual, comercial de niños y adolescentes`, "</td></tr>",
      "<tr><td><b>Negligencia y abandono:</b> ", `Negligencia y abandono`, "</td></tr>",
      "<tr><td><b>Otras violencias sexuales:</b> ", `Otras violencias sexuales`, "</td></tr>",
      "<tr><td><b>Otros actos sexuales:</b> ", `Otros actos sexuales`, "</td></tr>",
      "<tr><td><b>Sin información:</b> ", `Sin información`, "</td></tr>",
      "<tr><td><b>Trata de personas:</b> ", `Trata de personas`, "</td></tr>",
      "<tr><td><b>Violación:</b> ", Violación, "</td></tr>",
      "<tr><td><b>Violencia física:</b> ", `Violencia física`, "</td></tr>",
      "<tr><td><b>Violencia psicológica:</b> ", `Violencia psicologica`, "</td></tr>",
      "</table>"
    )
  ) %>%
  addLegend(
    pal = paleta_colores,
    values = ~Total_casos,
    title = "Total de Casos",
    position = "bottomright"
  )

```
```{r,echo=FALSE,warning=FALSE}
mapa
```

El mapa revela patrones de violencia diversos y complejos que varían entre los departamentos, con algunos tipos específicos que afectan de manera particular a cada región. En Antioquia, además de las altas incidencias de "Violencia física" y "Negligencia y abandono," también se observa un número significativo de casos de "Acoso sexual" y "Violación," lo cual podría relacionarse con factores culturales y socioeconómicos que requieren atención focalizada en temas de educación y prevención en ámbitos tanto públicos como privados. En Bogotá, la distribución de casos es equilibrada entre "Negligencia y abandono" y "Violencia física," pero con una presencia relevante de "Acoso sexual," "Actos sexuales" y "Explotación sexual comercial de niños y adolescentes." Este perfil urbano sugiere desafíos específicos de seguridad y vulnerabilidad infantil que podrían estar vinculados a la densidad poblacional y movilidad social constante, destacando la necesidad de programas de intervención en prevención y protección infantil.

Amazonas, aunque con cifras más bajas en algunas categorías, presenta un perfil particular de violencia con un alto número de casos en "Negligencia y abandono" y "Violencia física," junto con incidentes de "Abuso sexual." Esto puede estar asociado a la falta de acceso a recursos básicos y a la atención para poblaciones en áreas rurales y remotas, lo que destaca una necesidad crítica de apoyo en infraestructuras sociales y de protección. Cundinamarca, por otro lado, muestra una alta prevalencia de "Violencia física" y "Negligencia y abandono," además de casos de "Acoso sexual" y "Otros actos sexuales." Estos datos subrayan una complejidad en la dinámica de violencia, donde el acoso y otros actos sexuales requieren un enfoque multidimensional para mejorar las políticas de prevención y control, especialmente en contextos con mayor interacción social.

En Valle del Cauca, junto a las categorías dominantes de "Violencia física" y "Negligencia y abandono," hay una incidencia importante de "Violación" y "Trata de personas." Esto indica desafíos urbanos adicionales relacionados con la seguridad y la explotación, lo que sugiere la necesidad de políticas más estrictas para enfrentar situaciones de tráfico y abuso, así como de fortalecer la protección en áreas vulnerables. En departamentos con menos casos reportados, como Vaupés y Guainía, aunque las cifras son bajas, existe la presencia de "Negligencia y abandono," "Violencia física" y algunos casos de "Abuso sexual." La limitación en la recolección de datos en estas áreas puede ocultar problemáticas mayores en términos de violencia, especialmente en contextos de población indígena y rural, donde el acceso a servicios de protección y denuncia es limitado.

###  Número de casos de violencia de género registrados por escenario

```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(kableExtra)

total_casos <- violencia_genero %>% summarise(total = n()) %>% pull(total)

tabla_escenarios <- violencia_genero %>%
  group_by(escenario) %>%
  summarise(`Número de Casos` = n(), .groups = 'drop') %>%
  mutate(Proporción = format(round(`Número de Casos` / total_casos, 4), nsmall = 4),
         Porcentaje = paste0(format(round(`Número de Casos` / total_casos * 100, 2), nsmall = 2), "%")) %>%
  arrange(desc(`Número de Casos`))

tabla_escenarios %>%
  kable("html", align = "c", digits = 0, 
        caption = "Frecuencia de Casos por Escenario") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")


```

La tabla muestra la frecuencia de casos de violencia desglosada por escenario donde ocurrieron los incidentes, expresando tanto el número absoluto de casos como la proporción y el porcentaje que representa cada escenario en el total. Este desglose permite observar cómo ciertos contextos presentan una mayor probabilidad de ser escenarios de violencia en comparación con otros. El hogar o domicilio destaca como el escenario más frecuente, con 8,132 casos, lo que representa un 66.69% del total. Esta cifra implica que es altamente probable que la violencia ocurra en el ámbito doméstico, probablemente debido a la cercanía y las relaciones de dependencia que se dan en este espacio. La proporción de 0.6669 indica que, en términos relativos, casi dos tercios de los incidentes se concentran en el hogar, lo cual subraya la importancia de políticas de prevención centradas en el entorno familiar.

La vía pública es el segundo escenario más común, con 2,183 casos (17.90%). Esto sugiere que, aunque menos frecuente que en el hogar, es relativamente probable que la violencia ocurra en espacios públicos. Factores como la exposición al entorno y la posibilidad de encuentros casuales pueden influir en la incidencia de estos casos en lugares públicos. La probabilidad de que un incidente de violencia ocurra en la vía pública sigue siendo significativa, ya que representa casi una quinta parte de los casos. El grupo de "otros" aparece como el tercer escenario más frecuente, con 975 casos (8.00%), lo cual podría abarcar una variedad de lugares no especificados que aún representan una cantidad considerable de incidentes. Aunque no hay una especificidad en este grupo, su proporción indica que existen otros contextos relevantes que deberían investigarse más a fondo para entender mejor los escenarios de riesgo.

Otros escenarios, como los establecimientos educativos y espacios abiertos, presentan frecuencias menores, con 331 casos (2.71%) y 164 casos (1.35%), respectivamente. Aunque estos lugares no son los más frecuentes, su presencia en la tabla indica que existe una baja probabilidad de que incidentes de violencia ocurran en ellos, pero no se puede descartar. Espacios como comercios, instituciones de salud, y lugares de trabajo tienen aún menores incidencias, todos con porcentajes inferiores al 1.1%. Estos valores sugieren que la violencia en estos lugares es relativamente poco probable en comparación con el hogar o la vía pública. Finalmente, los lugares de esparcimiento con expendio de alcohol (0.53%) y las áreas deportivas y recreativas (0.24%) tienen las frecuencias más bajas de casos de violencia. La baja proporción y porcentaje en estos contextos indican que es poco probable que ocurra violencia en estos lugares en comparación con otros escenarios. En conclusión, la tabla indica que es muy probable que los casos de violencia ocurran en el ámbito doméstico, seguido por la vía pública, mientras que es menos probable en espacios como establecimientos educativos, lugares de trabajo y áreas de esparcimiento. Esta información es crucial para orientar las estrategias de prevención de acuerdo con la probabilidad de incidencia en cada tipo de escenario.

A continuación, se presentan los casos reportados por tipo de violencia en cada escenario para darle mayor profundidad al análisis:

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(plotly)
library(readxl)
library(dplyr)

tabla_escenario <- read_xlsx("Frecuencia_def_naturaleza_por_Escenario.xlsx")

tabla_escenario$popup_label <- paste(
  "<b>Escenario:</b> ", tabla_escenario$escenario, "<br>",
  "<b>Total de casos:</b> ", tabla_escenario$Total, "<br>",
  "Abuso sexual: ", ifelse(is.na(tabla_escenario$`Abuso sexual`), 0, tabla_escenario$`Abuso sexual`), "<br>",
  "Acceso carnal: ", ifelse(is.na(tabla_escenario$`Acceso carnal`), 0, tabla_escenario$`Acceso carnal`), "<br>",
  "Acoso sexual: ", ifelse(is.na(tabla_escenario$`Acoso sexual`), 0, tabla_escenario$`Acoso sexual`), "<br>",
  "Actos sexuales: ", ifelse(is.na(tabla_escenario$`Actos sexuales`), 0, tabla_escenario$`Actos sexuales`), "<br>",
  "Actos sexuales de violencia: ", ifelse(is.na(tabla_escenario$`Actos sexuales de violencia`), 0, tabla_escenario$`Actos sexuales de violencia`), "<br>",
  "Desconocida: ", ifelse(is.na(tabla_escenario$Desconocida), 0, tabla_escenario$Desconocida), "<br>",
  "Explotación sexual comercial: ", ifelse(is.na(tabla_escenario$`Explotación sexual, comercial de niños y adolescentes`), 0, tabla_escenario$`Explotación sexual, comercial de niños y adolescentes`), "<br>",
  "Negligencia y abandono: ", ifelse(is.na(tabla_escenario$`Negligencia y abandono`), 0, tabla_escenario$`Negligencia y abandono`), "<br>",
  "Otras violencias sexuales: ", ifelse(is.na(tabla_escenario$`Otras violencias sexuales`), 0, tabla_escenario$`Otras violencias sexuales`), "<br>",
  "Otros actos sexuales: ", ifelse(is.na(tabla_escenario$`Otros actos sexuales`), 0, tabla_escenario$`Otros actos sexuales`), "<br>",
  "Sin información: ", ifelse(is.na(tabla_escenario$`Sin información`), 0, tabla_escenario$`Sin información`), "<br>",
  "Trata de personas: ", ifelse(is.na(tabla_escenario$`Trata de personas`), 0, tabla_escenario$`Trata de personas`), "<br>",
  "Violación: ", ifelse(is.na(tabla_escenario$Violación), 0, tabla_escenario$Violación), "<br>",
  "Violencia física: ", ifelse(is.na(tabla_escenario$`Violencia física`), 0, tabla_escenario$`Violencia física`), "<br>",
  "Violencia psicológica: ", ifelse(is.na(tabla_escenario$`Violencia psicologica`), 0, tabla_escenario$`Violencia psicologica`)
)

color_map <- c(
  "Hogar o domicilio" = "lightblue",
  "Comercio y áreas de servicios" = "lightgreen",
  "Establecimiento educativo" = "orange",
  "Institución de salud" = "pink",
  "Lugar de trabajo" = "purple",
  "Lugares de esparcimiento con expendido de alcohol" = "red",
  "Otros" = "gray",
  "Otros espacios abiertos" = "yellow",
  "Vía pública" = "brown",
  "Área deportiva y recreativa" = "darkblue"
)

tabla_escenario$color <- color_map[tabla_escenario$escenario]

plot <- plot_ly(
  data = tabla_escenario,
  type = "treemap",
  labels = ~escenario,
  values = ~Total,
  parents = NA,
  marker = list(
    colors = ~color,
    line = list(color = "black", width = 2)
  ),
  text = ~escenario,
  textinfo = "label",  
  textposition = "middle center",
  textfont = list(color = "black", size = 14, family = "Arial", weight = "bold"),
  hoverinfo = "text",
  hovertext = ~popup_label,
  hoverlabel = list(bgcolor = "white", font = list(color = "black"), align = "left")
) %>%
  layout(
    title = list(
      text = "<b>Casos de Violencia por Escenario y Tipo</b>",
      x = 0.5,
      y = 0.95,
      xanchor = "center",
      yanchor = "top",
      font = list(size = 16)
    ),
    uniformtext = list(minsize = 10, mode = "hide"),  
    showlegend = FALSE,
    margin = list(r = 50, b = 110)  
  )

plot
```

Los datos muestran que el hogar es el principal escenario de violencia, con alta incidencia de negligencia y abandono (3150 casos), seguido de violencia física (2724 casos) y abuso sexual (611 casos), destacando preocupaciones sobre la seguridad en este entorno. En la vía pública, la violencia física es común (1159 casos), junto con actos sexuales de violencia (290 casos), evidenciando riesgos significativos en espacios abiertos. En la categoría de otros contextos, predomina la violencia física (24%), seguida de violencia psicológica y negligencia, lo que indica exposición diversa a agresiones. En establecimientos educativos, la negligencia es el tipo de violencia más frecuente (29.3%), acompañada de violencia física (17.8%) y abuso sexual (12%), sugiriendo vulnerabilidades en estos espacios. En instituciones de salud, aunque con menos casos, predomina la negligencia (76.1%), señalando áreas de descuido hacia pacientes. En el ambiente laboral, destacan los casos de violencia física (68.9%) y acoso sexual, subrayando la necesidad de entornos de trabajo seguros.En resumen, el hogar y la vía pública son los escenarios con mayor incidencia de violencia, especialmente en negligencia, violencia física y abuso sexual en el hogar, y violencia física en espacios públicos. Otros contextos, como el educativo y laboral, también requieren medidas de protección específicas, indicando una necesidad urgente de políticas adaptadas a cada entorno de riesgo.

###  Número de casos de violencia de género por estrato de la víctima

```{r,echo=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)

violencia_por_estrato <- violencia_genero %>%
  count(estrato) %>%
  arrange(estrato)

ggplot(violencia_por_estrato, aes(x = as.factor(estrato), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = n), vjust = -0.2, color = "black", size = 3.5) +
  labs(
    title = "Frecuencia de Casos de Violencia por Estrato",
    x = "Estrato",
    y = "Casos Registrados"
  ) +
  theme_classic() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title.x = element_text(face = "bold", size = 12),
    axis.title.y = element_text(face = "bold", size = 12),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.line = element_line(color = "gray50", size = 0.5),
    panel.grid.major.y = element_line(color = "gray80", size = 0.3),
    panel.grid.minor = element_blank()
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)))


```

La gráfica muestra que la violencia de género es más frecuente en los estratos socioeconómicos bajos, con el estrato 1 registrando 4,924 casos, seguido del estrato 2 con 3,660 y el estrato 3 con 2,393. Esto sugiere que la violencia de género es más prevalente en contextos de menor nivel socioeconómico, donde factores como la inestabilidad económica y el acceso limitado a recursos aumentan la vulnerabilidad. Desde una perspectiva de probabilidad, los datos indican que la probabilidad de ser víctima de violencia de género es mayor en los estratos bajos y disminuye progresivamente en los estratos altos, donde se registran menos casos (estrato 4 con 589 casos, estrato 5 con 377 y estrato 6 con 250). Ahora bien, al entrelazar el análisis del nivel socioeconómico de la víctima con su género, nos permite  analizar las diferencias en cómo distintos géneros experimentan o enfrentan situaciones de riesgo o de desigualdad según su nivel socioeconómico, como se muestra a continuación:

```{r,echo=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)

violencia_genero$grupo_estrato <- factor(violencia_genero$estrato)
violencia_genero$genero_victima <- factor(violencia_genero$sexo_victima, levels = c("Masculino", "Femenino"))

datos_resumidos <- violencia_genero %>%
  group_by(grupo_estrato, genero_victima) %>%
  summarise(total_casos = n(), .groups = 'drop')

ggplot(datos_resumidos, aes(x = grupo_estrato, y = total_casos, fill = genero_victima)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
  geom_text(aes(label = total_casos), vjust = -0.3, position = position_dodge(width = 0.9), size = 3) +
  scale_fill_manual(values = c("#1f78b4", "#a6cee3")) +
  scale_y_continuous(limits = c(0, 4000), expand = c(0, 0)) +
  labs(
    title = "Distribución de Víctimas por Estrato y Género",
    x = "Estrato Socioeconómico",
    y = "Número de Casos",
    fill = "Género de la Víctima"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank(),
    axis.line.x = element_line(color = "black"),
    axis.line.y = element_line(color = "black"),
    plot.title = element_text(hjust = 0.5, face = "bold")
  )


```

La gráfica revela una clara relación entre el género de las víctimas y su estrato socioeconómico, mostrando patrones que sugieren cómo ambos factores interactúan en el contexto de los casos registrados. En los estratos socioeconómicos más bajos, particularmente en los estratos 1 y 2, se observa una marcada diferencia entre los géneros, con un mayor número de casos reportados por mujeres en comparación con hombres. Esta diferencia sugiere que, en contextos de menor nivel socioeconómico, las mujeres pueden enfrentar mayores situaciones de vulnerabilidad o tener menos acceso a recursos y redes de apoyo, lo que las hace más propensas a ser víctimas de situaciones de violencia.A medida que el estrato aumenta, se observa una disminución general en el número de casos para ambos géneros. Sin embargo, incluso en los estratos más altos (4, 5 y 6), la tendencia de mayor incidencia en mujeres persiste. Aunque la brecha de género en estos estratos es menor que en los estratos bajos, las mujeres siguen reportando más casos que los hombres. Esto sugiere que, independientemente del nivel socioeconómico, las mujeres son consistentemente más afectadas, aunque la magnitud de esta diferencia se acentúa en los estratos bajos. En términos generales, mientras que el género femenino es sistemáticamente más vulnerable en todos los niveles socioeconómicos, esta vulnerabilidad es especialmente pronunciada en los estratos socioeconómicos más bajos, donde la disparidad de género en el número de víctimas es más significativa. Si, por otro lado, nos centramos en analizar la relación existente entre el nivel socioeconómico y el ciclo de vida de la víctima para revelar cómo las desigualdades económicas y el ciclo de vida influyen en la exposición y la vulnerabilidad a este tipo de violencia, se obtendrían las siguientes estadísticas:

```{r,echo=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)
 
datos_resumidos_estrato_ciclo <- violencia_genero %>%
  group_by(grupo_estrato, `Ciclo de vida`) %>%
  summarise(total_casos = n(), .groups = 'drop')

ggplot(datos_resumidos_estrato_ciclo, aes(x = grupo_estrato, y = total_casos, fill = grupo_estrato)) +
  geom_bar(stat = "identity", width = 0.8) +
  geom_hline(yintercept = 0, color = "black", size = 0.5) +  # Delinear el "eje x" en y = 0
  geom_text(aes(label = total_casos), vjust = -0.3, size = 3) +
  scale_fill_manual(values = c("#1f78b4", "#6baed6", "#a6cee3", "#c6dbef", "#e0f3ff", "gray")) +
  scale_y_continuous(limits = c(0, 1600), expand = c(0, 0.05)) +  
  labs(
    title = "Distribución de Víctimas por Estrato y Ciclo de Vida",
    x = "Estrato Socioeconómico",
    y = "Número de Casos",
    fill = "Estrato"
  ) +
  facet_wrap(~ `Ciclo de vida`) +
  theme_minimal() +
  theme(
    axis.text.x = element_blank(),  
    axis.title.x = element_blank(), 
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank(),
    axis.line.y = element_line(color = "black"), 
    plot.title = element_text(hjust = 0.5, face = "bold"),
    strip.text = element_text(face = "bold", size = 10)
  )


```

Como se evidencia, en "Primera infancia," observamos un claro predominio de víctimas en el estrato 1, con 1493 casos. Esta cifra disminuye progresivamente en los estratos superiores, lo que indica una concentración de casos en los niveles socioeconómicos más bajos. Esta misma tendencia se mantiene en la siguiente etapa, "Infancia," donde el estrato 1 sigue siendo el más afectado, aunque con un menor número de casos (638). A medida que avanzamos a los estratos 4, 5 y 6, el número de víctimas se reduce notablemente, con menos de 100 casos en cada uno de estos niveles. La etapa de "Adolescencia" presenta un patrón similar, con 943 casos en el estrato 1 y una disminución en los estratos más altos. En esta fase, los estratos 2 y 3 también muestran una cantidad significativa de casos, aunque claramente menor que en el estrato 1. A partir de la etapa de "Juventud," vemos una disminución general en el número de casos en comparación con las etapas anteriores, pero el estrato 1 aún predomina con 890 casos, seguido de una presencia notable en el estrato 2 (684). Nuevamente, los estratos más altos tienen una representación mínima.

En la etapa de "Adultez," el estrato 1 continúa liderando en términos de casos, con 807, seguido por el estrato 2. A medida que avanzamos hacia los estratos superiores, los números disminuyen significativamente, con una mínima representación en los estratos 4, 5 y 6. Finalmente, en "Persona Mayor," el número de casos es considerablemente menor en general, pero el estrato 1 sigue siendo el más afectado, con 153 casos, mientras que los demás estratos muestran cifras muy bajas. En resumen, la gráfica revela una tendencia clara: el estrato 1 concentra la mayor cantidad de víctimas en todas las etapas de la vida, mientras que los estratos más altos tienen una representación mucho menor. Esto sugiere una relación entre el nivel socioeconómico bajo y una mayor prevalencia de víctimas de violencia de género, independientemente de la etapa del ciclo de vida. Las etapas de "Primera infancia," "Adolescencia," y "Juventud" presentan el mayor número de casos en general, mientras que las personas mayores tienen menos incidencia en todos los estratos.

Si combinamos las dos variables analizadas previamente junto con la posición socioeconómica de la víctima, obtendremos las siguientes probabilidades condicionales de ser víctima de violencia de género en función del género, el estrato socioeconómico y el ciclo de vida de las personas afectadas. A través de este análisis probabilístico, se busca identificar cómo la probabilidad de experimentar violencia de género varía según estos factores, resaltando patrones de riesgo específicos que pueden orientar intervenciones focalizadas en los grupos más vulnerables.

```{r,echo=FALSE,warning=FALSE,message=FALSE}

library(dplyr)
library(DT)

ciclos_de_vida_ordenados <- c("Primera infancia", "Infancia", "Adolescencia", "Juventud", "Adultez", "Persona Mayor")

data_filtrada_estrato <- violencia_genero

tabla_conteo_estrato <- data_filtrada_estrato %>%
  group_by(sexo_victima, `Ciclo de vida`, estrato) %>%
  summarise(casos = n()) %>%
  ungroup()

total_ciclo_genero_estrato <- data_filtrada_estrato %>%
  group_by(sexo_victima, `Ciclo de vida`) %>%
  summarise(total = n()) %>%
  ungroup()

tabla_probabilidades_estrato <- tabla_conteo_estrato %>%
  left_join(total_ciclo_genero_estrato, by = c("sexo_victima", "Ciclo de vida")) %>%
  mutate(probabilidad = round(casos / total, 4),
         porcentaje = paste0(round(probabilidad * 100, 2), "%"),
         enunciado = paste0("P(", sexo_victima, " | ", estrato, " ∩ ", `Ciclo de vida`, ")")) %>%
  arrange(factor(`Ciclo de vida`, levels = ciclos_de_vida_ordenados)) %>%
  select(enunciado, probabilidad, porcentaje)

datatable(tabla_probabilidades_estrato, 
          colnames = c("Enunciado", "Probabilidad", "Porcentaje"),
          caption = "Probabilidades Condicionales de Ser Víctima de Violencia de Género por Ciclo de Vida y Estrato",
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")), 
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("probabilidad"), digits = 2)


```

En la Primera Infancia, las probabilidades condicionales revelan que el evento de victimización es más probable para niñas y niños en el estrato socioeconómico más bajo, con un riesgo cercano al 40% para ambos géneros en este contexto. Esta probabilidad disminuye gradualmente en los estratos superiores, lo que sugiere una relación de dependencia entre la condición socioeconómica y la exposición a situaciones de violencia. Este fenómeno puede explicarse en parte por la vulnerabilidad asociada a las limitaciones económicas, que crean un entorno propicio para la ocurrencia de este tipo de eventos en los hogares con menos recursos. En la Infancia, el patrón de dependencia estadística se mantiene, con una alta probabilidad de que el suceso de violencia de género ocurra en el estrato bajo. Las niñas presentan una probabilidad ligeramente superior a los niños, lo que indica que el género también puede jugar un rol en la exposición al riesgo en esta etapa, aunque el estrato socioeconómico sigue siendo el factor dominante. Esto sugiere que, condicionada al estrato bajo, la infancia es un ciclo de vida especialmente vulnerable, ya que las condiciones económicas desfavorables parecen intensificar el riesgo de que ocurra el evento de violencia.

Durante la Adolescencia, el riesgo de victimización sigue siendo elevado en el estrato más bajo para ambos géneros, lo que refleja una distribución de probabilidad sesgada hacia los estratos bajos en esta etapa crítica del desarrollo. La persistencia de una alta probabilidad de que ocurra este suceso en el contexto de bajos recursos sugiere que existen condiciones estructurales específicas en estos entornos que favorecen la incidencia de violencia. La adolescencia, una etapa marcada por el aumento de interacciones sociales y vulnerabilidades propias del desarrollo, amplifica la susceptibilidad a este tipo de sucesos, particularmente en los contextos económicos más desfavorecidos. En las etapas de Juventud y Adultez, se observa una disminución en las probabilidades de que ocurra el evento de violencia de género, especialmente en comparación con las etapas anteriores de vida. No obstante, el estrato 1 continúa mostrando el mayor riesgo relativo para ambos géneros. Aunque el riesgo disminuye en términos absolutos, la probabilidad condicional de que una persona en el estrato bajo sea víctima sigue siendo notablemente mayor que en los estratos superiores. Esto evidencia que, aunque el suceso de violencia se vuelve menos común con la edad, el entorno socioeconómico sigue jugando un papel importante en la probabilidad de su ocurrencia.

En la etapa de Persona Mayor, las probabilidades condicionales se reducen aún más, pero el estrato más bajo continúa siendo el contexto de mayor riesgo. Aunque la incidencia de violencia de género disminuye en esta etapa, los adultos mayores en el estrato bajo presentan una vulnerabilidad constante, lo que indica que, a lo largo de la vida, el estrato socioeconómico influye en la probabilidad de exposición a la violencia. La persistencia de esta relación sugiere una fuerte interdependencia entre la situación económica y la exposición a este tipo de eventos, destacando la relevancia de las condiciones materiales en la protección o vulnerabilidad frente a la violencia. En resumen, el análisis probabilístico muestra una clara dependencia entre el estrato socioeconómico y la probabilidad de ser víctima de violencia de género en todas las etapas de la vida, con un mayor riesgo en los estratos más bajos. Este patrón indica una fuerte correlación entre las condiciones económicas y la vulnerabilidad a la violencia de género.

Por último, el análisis de la relación entre el estrato y el tipo de violencia al cual se expuso la víctima tambien es relevante, puesto que permite entender cómo las condiciones económicas afectan la exposición y naturaleza de la violencia que sufren las víctimas. A continuación, se presenta la relación entre estás dos variables: 

```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(tidyr)
library(kableExtra)

estrato_column_order <- c("1", "2", "3", "4", "5", "6")

contingency_table <- violencia_genero %>%
  count(tipo_violencia = def_naturaleza, estrato_socio = estrato) %>%
  pivot_wider(names_from = estrato_socio, values_from = n, values_fill = list(n = 0)) %>%
  select(tipo_violencia, all_of(estrato_column_order))

names(contingency_table)[names(contingency_table) == "tipo_violencia"] <- "Tipos de Violencia"

contingency_table %>%
  kable("html", align = "c", digits = 0, 
        caption = "Frecuencia de Casos de Violencia por Tipos de Violencia y Estrato Socioeconómico") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")

```

La tabla muestra que los casos de violencia están predominantemente concentrados en los estratos socioeconómicos más bajos, especialmente en el estrato 1, donde se reportan frecuencias mucho más altas en casi todos los tipos de violencia. Por ejemplo, en violencia física se registran 1599 casos en el estrato 1, frente a solo 93 en el estrato 6. Del mismo modo, en negligencia y abandono, el estrato 1 presenta 1917 casos, mientras que en el estrato 6 la cifra cae a solo 60 casos. Esto sugiere que la falta de recursos en los contextos de menor nivel socioeconómico podría estar asociada con una mayor exposición a estos tipos de violencia, posiblemente debido a factores de precariedad y limitada red de apoyo. En contraste, la violencia psicológica muestra una distribución algo más uniforme en comparación con otros tipos de violencia. En el estrato 1 hay 219 casos, pero en el estrato 6 aún se observan 10 casos. Esto sugiere que la violencia psicológica es menos dependiente de la situación económica y puede afectar a individuos en una variedad de contextos socioeconómicos, indicando que, a diferencia de la violencia física o el abandono, esta forma de violencia podría ser una experiencia transversal que afecta a todos los niveles. 

Los tipos de violencia como la trata de personas y la explotación sexual comercial de niños y adolescentes muestran una baja frecuencia en todos los estratos, con un total de 0 a 5 casos en la mayoría de los estratos. Esto podría deberse a que estos casos son más específicos y menos reportados, o están vinculados a otros factores diferentes al estrato socioeconómico, como el contexto social o la movilidad geográfica de las víctimas. En conjunto, el análisis sugiere que, aunque todos los estratos pueden experimentar diferentes tipos de violencia, los estratos bajos son considerablemente más vulnerables. Esto subraya la importancia de crear políticas de intervención que prioricen la prevención y el apoyo en los estratos más desfavorecidos, abordando de manera focalizada las necesidades de las comunidades con menos recursos y promoviendo la equidad en el acceso a servicios y apoyo.

A partir del análisis de estas tres variables en relación con el estrato de la víctima, es posible calcular probabilidades compuestas que indiquen la probabilidad de que una persona sea víctima de un tipo específico de violencia, considerando su género, ciclo de vida y nivel socioeconómico. Este enfoque resulta fundamental para anticipar escenarios de riesgo en contextos específicos y optimizar la asignación de recursos en programas de prevención, focalizando su efectividad en los perfiles más vulnerables. A continuación, se presentan dichas probabilidades, restringidas a los estratos socioeconómicos con mayor número de casos registrados para facilitar el análisis:

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(dplyr)
library(DT)

tipos_principales_2 <- c("Violencia física", "Abuso sexual", "Negligencia y abandono")

ciclos_de_vida_ordenados_2 <- c("Primera infancia", "Infancia", "Adolescencia", "Juventud", "Adultez", "Persona Mayor")

data_filtrada_2 <- violencia_genero %>%
  filter(def_naturaleza %in% tipos_principales_2, estrato %in% c(1, 2, 3))

tabla_conteo_2 <- data_filtrada_2 %>%
  group_by(sexo_victima, `Ciclo de vida`, estrato, def_naturaleza) %>%
  summarise(casos = n(), .groups = 'drop')

total_genero_ciclo_estrato <- data_filtrada_2 %>%
  group_by(sexo_victima, `Ciclo de vida`, estrato) %>%
  summarise(total = n(), .groups = 'drop')

tabla_probabilidades_2 <- tabla_conteo_2 %>%
  left_join(total_genero_ciclo_estrato, by = c("sexo_victima", "Ciclo de vida", "estrato")) %>%
  mutate(probabilidad = round(casos / total, 4),  
         porcentaje = paste0(round(probabilidad * 100, 2), "%"),
         enunciado = paste0("P(", def_naturaleza, " | ", sexo_victima, " ∩ ", estrato, " ∩ ", `Ciclo de vida`, ")")) %>%
  arrange(factor(`Ciclo de vida`, levels = ciclos_de_vida_ordenados_2)) %>%
  select(enunciado, probabilidad, porcentaje)

datatable(tabla_probabilidades_2, 
          colnames = c("Enunciado", "Probabilidad", "Porcentaje"),
          caption = "Probabilidades Condicionales de Ser Víctima de los Principales Tipos de Violencia por Género, Ciclo de Vida y Estrato (Estratos 1-3)",
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")), 
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("probabilidad"), digits = 4)

```

Al analizar las probabilidades condicionales de victimización por violencia física, abuso sexual y negligencia y abandono, observamos que las diferentes combinaciones de sexo, estrato socioeconómico y ciclo de vida juegan un papel fundamental en determinar el perfil de los grupos más vulnerables. En particular, los estratos bajos (estrato 1 y 2) muestran una mayor probabilidad de victimización en todos los tipos de violencia, lo que subraya la fuerte influencia de las condiciones socioeconómicas en la exposición a la violencia.

Las mujeres tienen una mayor probabilidad de ser víctimas de violencia física desde la Primera Infancia hasta la adultez, especialmente en estratos bajos. La probabilidad de victimización aumenta considerablemente en la Juventud y Adultez, donde se observa que las mujeres en estratos más bajos tienen una alta incidencia de violencia física. Este patrón podría estar relacionado con dinámicas de violencia de género y abuso doméstico, que afectan de manera desproporcionada a las mujeres en contextos de vulnerabilidad económica. Por otro lado, aunque los hombres también enfrentan altas probabilidades de violencia física en la Juventud, especialmente en estratos bajos, el patrón es ligeramente diferente, ya que la violencia física en hombres está más vinculada a factores de violencia estructural y conflictos interpersonales.

En relación con el abuso sexual, las adolescentes mujeres de estratos bajos son las más vulnerables, con probabilidades que superan el 70% en algunas combinaciones de ciclo de vida y estrato. Este patrón refleja la vulnerabilidad de las adolescentes en situaciones de pobreza y falta de protección, donde la falta de recursos y la inseguridad social contribuyen al riesgo de abuso. Aunque los hombres adolescentes también son víctimas de abuso sexual, la probabilidad es significativamente menor que en las mujeres, pero aún relevante, especialmente en contextos de estratos bajos y situaciones de abuso en el hogar o entorno social.

En cuanto a la negligencia y abandono, las probabilidades son más altas en los extremos del ciclo de vida. Los niños pequeños en estratos bajos tienen la mayor probabilidad de ser víctimas de negligencia, con probabilidades que superan el 75% en muchas combinaciones de sexo y estrato. Este patrón refleja la extrema vulnerabilidad de los niños pequeños que dependen completamente de los cuidadores, especialmente en contextos de pobreza o disfunción familiar. En las personas mayores, también en estratos bajos, la probabilidad de negligencia y abandono es considerable, alcanzando hasta el 58%, lo que indica que los adultos mayores en condiciones de vulnerabilidad económica también enfrentan altos riesgos de abuso y abandono, generalmente debido a la dependencia y la falta de apoyo familiar.

En general, la violencia física es más prevalente en los estratos bajos para ambos sexos, pero afecta particularmente a las mujeres desde la infancia hasta la adultez, con picos significativos en la juventud y adultez. Por otro lado, el abuso sexual es más prevalente entre las adolescentes mujeres en estratos bajos, destacándose como un tipo de violencia que afecta gravemente a este grupo, mientras que los adolescentes masculinos también son vulnerables, aunque en menor medida. La negligencia y abandono afecta principalmente a los niños pequeños y personas mayores en estratos bajos, lo que subraya la necesidad urgente de políticas de protección y apoyo para estos grupos vulnerables.


# Análisis descriptivos demográficos generales de los agresores de violencia de género en colombia entre los años 2015-2023

En este apartado se presenta un análisis descriptivo de las características demográficas de los agresores de violencia de género en Colombia entre 2015 y 2023, abordando aspectos clave como la edad, género, antecedentes, parentesco con la víctima y si se registró su captura. Estos factores ofrecen una visión integral sobre el perfil de los agresores, lo que resulta fundamental para entender los patrones de violencia y orientar estrategias preventivas. La relevancia de este análisis radica en su potencial para identificar factores de riesgo específicos y contribuir a políticas de intervención más efectivas en la prevención y reducción de la violencia de género.

## Análisis general de las edades de los agresores de violencia de género

```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(kableExtra)

violencia_genero$edad_agre <- as.numeric(as.character(violencia_genero$edad_agre))
violencia_genero <- violencia_genero %>% filter(!is.na(edad_agre) & edad_agre >= 0 & edad_agre <= 100)

violencia_genero$edad_intervalo_agresor <- cut(
  violencia_genero$edad_agre, 
  breaks = c(seq(0, 90, by = 10), 100), 
  labels = c("[0-10)", "[10-20)", "[20-30)", "[30-40)", "[40-50)", "[50-60)", "[60-70)", "[70-80)", "[80-90)", "[90-100]"),
  right = FALSE,
  include.lowest = TRUE
)

tabla_frecuencia_agresores <- violencia_genero %>%
  group_by(edad_intervalo_agresor) %>%
  summarise(
    fi = n(),
    hi = round(fi / nrow(violencia_genero), 3)
  ) %>%
  mutate(
    Fi = cumsum(fi),
    Hi = round(cumsum(hi), 3),
    `hi (%)` = round(hi * 100, 3),
    `Hi (%)` = round(Hi * 100, 3)
  )

tabla_frecuencia_agresores %>%
  kable("html", align = "c", digits = 4, caption = "Tabla de Frecuencia de Edades de los Agresores") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), full_width = F, position = "center") %>%
  row_spec(0, bold = T, background = "#d0e4f5")


```

La tabla de frecuencia de edades de los agresores revela que el intervalo de 20 a 30 años presenta la mayor frecuencia absoluta, con 2,854 casos, representando el 23.4% de la población total de agresores. Esto destaca que los agresores jóvenes adultos constituyen el grupo de mayor incidencia en los casos de violencia de género. Siguiendo este grupo, el intervalo de 30 a 40 años presenta la segunda mayor frecuencia con 2,178 casos (17.9%), y luego el intervalo de 40 a 50 años, con 1,385 casos (11.4%). Esta concentración en los primeros años de la adultez sugiere que las agresiones están fuertemente asociadas a individuos en edades de alta actividad social y económica.

El análisis de la frecuencia acumulada y su porcentaje acumulado indica que la mayoría de los agresores se concentran en los grupos etarios de 20 a 50 años, un rango asociado con etapas social y laboralmente activas. Este patrón podría estar influido por factores culturales, personales y contextuales que aumentan la probabilidad de involucrarse en actos de violencia en estas etapas de la vida. Por otro lado, la baja frecuencia de agresores en el grupo de 0 a 10 años es coherente con lo que se esperaría, considerando las limitaciones naturales de esta etapa en términos de desarrollo. Aunque no se puede afirmar categóricamente, es probable que la falta de registros en este rango (0-10) refleje factores como la inmadurez física, emocional y social que caracterizan a los individuos en esta edad, los cuales pueden disminuir significativamente su participación en este tipo de comportamientos violentos.

En conclusión, el análisis de la distribución etaria de los agresores de violencia de género revela patrones importantes que pueden guiar el diseño de políticas preventivas y de intervención. La mayor concentración de agresores en los grupos de 20 a 50 años sugiere que las etapas de vida con mayor actividad social y laboral son también las de mayor riesgo en términos de comportamientos violentos. Este patrón podría estar vinculado con factores de estrés, relaciones de pareja y contexto social, lo cual resalta la necesidad de intervenciones específicas en estos rangos de edad. Además, la baja representación de agresores en edades tempranas y avanzadas apunta a un posible vínculo entre la madurez psicosocial y la propensión a involucrarse en actos violentos de esta naturaleza. Lo anterior, se puede evidenciar con mayor claridad en la siguiente gráfica: 

```{r,echo=FALSE,warning=FALSE,message=FALSE}
df_edadesagre <- data.frame(edadesagre_simetria = violencia_genero$edad_agre)
ggplot(df_edadesagre, aes(x = edadesagre_simetria)) +
  geom_histogram(aes(y = ..density..), breaks = seq(0, 100, by = 10), fill = "lightblue", color = "black", alpha = 0.5) +
  geom_density(color = "darkblue", size = 1) +
  labs(title = "Gráfica de Densidad e Histograma de Edades", x = "Edades", y = "Densidad") +
  theme_minimal() +
  theme(
    axis.line = element_line(color = "black"),
    axis.ticks = element_line(color = "black"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    plot.margin = margin(10, 10, 10, 10),
    plot.title = element_text(hjust = 0.5)
  ) +
  scale_x_continuous(breaks = seq(0, 100, by = 10), limits = c(0, 100), expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0))

```

La gráfica de densidad e histograma de edades de los agresores presenta una distribución asimétrica, claramente sesgada hacia la derecha, lo cual indica que la mayoría de los agresores se concentran en edades tempranas y medias de la vida adulta. La curva de densidad alcanza su punto máximo alrededor del intervalo de 20 a 30 años, lo que sugiere que esta es la edad con mayor incidencia de agresores.A diferencia de una distribución normal, que tiende a ser simétrica con una única moda en el centro, esta distribución es unimodal pero sesgada hacia los valores más bajos, con una cola que se extiende a la derecha hacia edades más avanzadas. Este sesgo indica que es menos probable encontrar agresores en rangos de edad más altos, especialmente después de los 50 años, donde la densidad disminuye considerablemente.

La disminución progresiva en la densidad a partir de los 30 años podría estar asociada a factores tanto sociales como psicológicos, donde se observa una reducción en comportamientos agresivos a medida que la edad avanza, posiblemente debido a cambios en el estilo de vida, aumento de la madurez emocional o menor exposición a contextos de riesgo. Además, la baja densidad en los extremos (particularmente en los menores de 10 años y mayores de 80 años) es esperable, ya que estos grupos no suelen estar involucrados en comportamientos de esta naturaleza debido a limitaciones tanto físicas como contextuales. En resumen, la distribución de edades sugiere una mayor probabilidad de encontrar agresores en edades tempranas y medias de la adultez, mientras que en edades avanzadas esta probabilidad disminuye notablemente, reflejando un patrón de incidencia de violencia que está lejos de la simetría de una distribución normal y más alineado con una distribución sesgada hacia la derecha.

### Estadísticos de las edades de los agresores por tipo de violencia de género

```{r,echo=FALSE, warning=FALSE}
library(dplyr)
library(kableExtra)

violencia_genero$def_naturaleza <- as.factor(violencia_genero$def_naturaleza)

estadisticos_por_naturaleza_agresores <- violencia_genero %>%
  group_by(def_naturaleza) %>%
  summarise(
    `Tipo de Violencia` = first(def_naturaleza), 
    `Media de Edad` = mean(edad_agre, na.rm = TRUE),
    `Mediana de Edad` = median(edad_agre, na.rm = TRUE),
    `Moda de Edad` = as.numeric(names(sort(table(edad_agre), decreasing = TRUE)[1])),
    `Desviación Estándar` = sd(edad_agre, na.rm = TRUE),
    `Varianza` = var(edad_agre, na.rm = TRUE),
    `Coeficiente de Variación` = (sd(edad_agre, na.rm = TRUE) / mean(edad_agre, na.rm = TRUE)) * 100,
    `Cuartil 1` = quantile(edad_agre, 0.25, na.rm = TRUE),
    `Cuartil 2` = quantile(edad_agre, 0.5, na.rm = TRUE),
    `Cuartil 3` = quantile(edad_agre, 0.75, na.rm = TRUE)
  )

estadisticos_por_naturaleza_agresores %>%
  select(`Tipo de Violencia`, `Media de Edad`, `Mediana de Edad`, `Moda de Edad`, `Desviación Estándar`, `Varianza`, `Coeficiente de Variación`, `Cuartil 1`, `Cuartil 2`, `Cuartil 3`) %>%
  kable("html", align = "c", digits = 2, 
        caption = "Estadísticos de Edad de los Agresores por Tipo de Violencia") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")


```

Esta tabla presenta un análisis detallado de las edades de los agresores en casos de violencia de género, segmentados por tipo de violencia. En términos generales, se observa que el promedio de edad de los agresores varía significativamente entre los distintos tipos de violencia, lo cual podría reflejar patrones de comportamiento asociados a ciertas etapas de la vida. Los agresores involucrados en "Explotación sexual, comercial de niños y adolescentes" presentan la mayor media de edad (61.33 años) y la mediana más alta (78 años), lo que sugiere que este tipo de violencia podría estar asociado a individuos de mayor edad. Esto se apoya además en el coeficiente de variación, que es relativamente alto (66.28%), indicando una gran dispersión en las edades de los agresores dentro de esta categoría.

En contraste, "Negligencia y abandono" muestra una media de edad significativamente más baja (40.34 años), lo cual es coherente con el perfil de agresores que posiblemente tengan responsabilidades de cuidado directo y, por lo tanto, pertenezcan a un grupo de edad más joven y activo. Este grupo también presenta una desviación estándar de 22.26, lo que implica una menor dispersión en comparación con otros tipos de violencia, sugiriendo una mayor concentración de agresores en torno a edades medias. Los tipos de violencia con mayores desviaciones estándar, como "Violencia física" (24.10) y "Violencia psicológica" (23.96), evidencian una variabilidad considerable en la edad de los agresores, lo cual podría indicar que estos tipos de violencia se manifiestan en diferentes etapas de la vida y no están restringidos a un rango etario específico. Además, el coeficiente de variación para estos tipos de violencia es moderado, lo que confirma que las edades de los agresores están distribuidas de forma relativamente amplia.

Por otro lado, tipos de violencia como "Actos sexuales de violencia" y "Acoso sexual" tienen una media de edad cercana a los 50 años, con cuartiles que se concentran en la mediana y la tercera parte de la vida adulta. Esto podría sugerir una tendencia hacia agresores en edades intermedias para este tipo de comportamientos. Finalmente, el análisis de los cuartiles revela que, para la mayoría de los tipos de violencia, el primer cuartil se sitúa en torno a los 20-30 años, lo que podría señalar que algunos agresores comienzan a incurrir en conductas violentas a edades tempranas.

A continuación, se presenta la tabla de frecuencia de los tipos de violencia por intervalos de edades de los agresores, para brindar mayor profundidad al análisis: 
```{r,echo=FALSE,warning=FALSE}
library(dplyr)
library(tidyr)
library(kableExtra)

violencia_genero$edad_intervalo_agresor <- cut(
  violencia_genero$edad_agre, 
  breaks = c(seq(0, 90, by = 10), 100), 
  labels = c("[0-10)", "[10-20)", "[20-30)", "[30-40)", "[40-50)", "[50-60)", "[60-70)", "[70-80)", "[80-90)", "[90-100]"),
  right = FALSE,
  include.lowest = TRUE
)
tabla_contingencia_agre <- violencia_genero %>%
  group_by(def_naturaleza, edad_intervalo_agresor) %>%
  summarise(frecuencia = n(), .groups = 'drop') %>%
  complete(def_naturaleza, edad_intervalo_agresor, fill = list(frecuencia = 0)) %>%
  pivot_wider(names_from = edad_intervalo_agresor, values_from = frecuencia)

names(tabla_contingencia_agre)[names(tabla_contingencia_agre) == "def_naturaleza"] <- "Tipo de Violencia"

tabla_contingencia_agre %>%
  kable("html", align = "c", digits = 4, caption = "Tabla de Contingencia entre Tipos de Violencia y Edades de los Agresores") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), full_width = F, position = "center") %>%
  row_spec(0, bold = T, background = "#d0e4f5")


```

Esta tabla de contingencia ofrece una visión amplia sobre la relación entre los tipos de violencia y la edad de los agresores, lo que permite identificar patrones significativos en el comportamiento de los agresores en diferentes etapas de la vida. La tabla organiza la información en rangos de edad de diez años, desde 0-10 hasta 90-100, permitiendo así una comparación precisa entre diferentes grupos etarios y los tipos de violencia asociados. En primer lugar, el tipo de violencia "Negligencia y abandono" destaca por su alta frecuencia en casi todos los rangos de edad, especialmente a partir de los 10 años. Esto refleja un fenómeno de violencia que no está restringido a una etapa de vida específica del agresor, sino que aparece de manera constante en todas las edades. La consistencia en la frecuencia de estos casos a través de los rangos de edad indica que la negligencia y el abandono son formas de violencia presentes de manera transversal, probablemente influenciadas por factores sociales y económicos que impactan a agresores de múltiples edades.

La "Violencia física" también muestra una alta incidencia, especialmente en los rangos de edad de 10-20 hasta 80-90. Este tipo de violencia parece ser un fenómeno común a lo largo de casi todas las edades adultas, con menores frecuencias solo en los extremos de la escala (0-10 y 90-100). La dispersión de la violencia física en edades tan amplias sugiere un patrón de comportamiento violento que se mantiene activo durante gran parte de la vida del agresor. Dentro de las formas de violencia sexual, como "Abuso sexual" y "Acoso sexual," se observa una alta concentración en los grupos etarios de 10-20 y 20-30 años. Este patrón sugiere que los agresores jóvenes están más asociados con este tipo de delitos en comparación con otros rangos de edad. De manera similar, otros actos sexuales, como "Acceso carnal," presentan una distribución significativa en estos mismos rangos, lo que parece indicar una inclinación de los agresores jóvenes hacia formas de violencia sexual. Esta concentración en los rangos de edad juvenil-adulta podría estar vinculada a factores de tipo social y cultural, donde la violencia sexual se manifiesta de forma más frecuente en estas edades.

Los grupos de edad en los extremos de la tabla, como 0-10 y 90-100 años, muestran una baja frecuencia en casi todos los tipos de violencia. Esto sugiere que los agresores en estos rangos son menos comunes o menos propensos a cometer ciertos tipos de violencia. La baja incidencia en estos extremos podría indicar una menor capacidad o propensión a cometer actos violentos en estas edades, o bien reflejar una menor visibilidad de este grupo en los registros de casos. La categoría de "Sin información" también destaca en esta tabla, con un número considerable de casos distribuidos en todos los grupos etarios, especialmente en los rangos de 10-20 y 20-30. La cantidad de datos sin especificar en cuanto a la edad del agresor limita la precisión del análisis y señala un vacío en la calidad de los registros que puede afectar la comprensión detallada de los patrones de edad. Otros tipos de violencia, como la "Trata de personas," muestran una baja frecuencia en toda la tabla, lo que podría sugerir una menor prevalencia o visibilidad de estos casos en comparación con formas de violencia más comunes. La "Violación," por su parte, presenta un número moderado de casos, principalmente concentrado en los rangos de 20-30 y 30-40 años, lo que indica un patrón menos disperso que otros tipos de violencia.

A continuación, se presenta una tabla de probabilidades condicionales que relaciona los 3 tipos de violencia de género más reportados con el intervalo de edad del agresor, con el fin de comprender la incidencia o propensión a actos de violencia en diferentes grupos etarios:

```{r,echo=FALSE,warning=FALSE,message=FALSE}

library(dplyr)
library(DT)
intervalos_edad_ordenados_agre <- c("[0-10)", "[10-20)", "[20-30)", "[30-40)", "[40-50)", "[50-60)", "[60-70)", "[70-80)", "[80-90)", "[90-100]")

violencia_genero <- violencia_genero %>%
  mutate(edad_intervalo_agresor = cut(
    edad_agre,
    breaks = c(seq(0, 90, by = 10), 100),
    labels = intervalos_edad_ordenados_agre,
    right = FALSE,
    include.lowest = TRUE
  ))

tipos_principales_agre <- c("Negligencia y abandono", "Violencia física", "Abuso sexual") 
violencia_genero_filtrada_agre <- violencia_genero %>%
  filter(def_naturaleza %in% tipos_principales_agre)


tabla_conteo_violencia_agre <- violencia_genero_filtrada_agre %>%
  group_by(def_naturaleza, edad_intervalo_agresor) %>%
  summarise(casos = n(), .groups = 'drop')


total_tipo_violencia_agre <- violencia_genero_filtrada_agre %>%
  group_by(def_naturaleza) %>%
  summarise(total = n(), .groups = 'drop')


tabla_probabilidades_violencia_agre <- tabla_conteo_violencia_agre %>%
  left_join(total_tipo_violencia_agre, by = "def_naturaleza") %>%
  mutate(
    probabilidad = round(casos / total, 4),
    porcentaje = paste0(round(probabilidad * 100, 2), "%"),
    enunciado = paste0("P(", edad_intervalo_agresor, " | ", def_naturaleza, ")")
  ) %>%
  arrange(factor(edad_intervalo_agresor, levels = intervalos_edad_ordenados_agre)) %>%
  select(enunciado, probabilidad, porcentaje)

datatable(tabla_probabilidades_violencia_agre, 
          colnames = c("Enunciado", "Probabilidad", "Porcentaje"),
          caption = "Probabilidad de que un Agresor Esté en un Intervalo de Edad Dado el Tipo de Violencia",
          escape = FALSE,
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")), 
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("probabilidad"), digits = 4)

```

La tabla presenta probabilidades de que un agresor esté en un intervalo de edad específico dado el tipo de violencia que comete, lo que permite identificar tendencias demográficas relacionadas con los actos violentos. En esta distribución, el intervalo de edad de 20 a 30 años muestra probabilidades destacables para actos de abuso sexual y violencia física, con una probabilidad de 0.1805 (18.05%) para abuso sexual y 0.2113 (21.13%) para violencia física, lo cual indica que los jóvenes adultos son más propensos a estar involucrados en estos sucesos. En contraste, para "Negligencia y abandono," la probabilidad máxima se observa en el mismo rango de edad, con 0.3139 (31.39%), reflejando que esta conducta es también prevalente en este grupo.

Conforme aumenta la edad, las probabilidades tienden a disminuir para la mayoría de los tipos de violencia, lo cual puede estar asociado con cambios en el comportamiento y el contexto social a lo largo del ciclo de vida. Por ejemplo, en el rango de edad de 50 a 60 años, la probabilidad de estar involucrado en "Abuso sexual" baja a 0.0839 (8.39%) y en "Negligencia y abandono" a 0.0653 (6.53%), reflejando una tendencia decreciente. Este patrón podría indicar que los individuos de mediana edad están menos expuestos a contextos o conductas que derivan en estos tipos de violencia, lo cual puede ser atribuible a factores como estabilidad familiar o laboral.

Sin embargo, los datos también muestran que aunque las probabilidades son más bajas en edades avanzadas, estas no desaparecen completamente. En el grupo de 70 a 80 años, aún existen probabilidades de 0.0546 (5.46%) para "Negligencia y abandono" y de 0.0782 (7.82%) para "Violencia física." Esto es relevante, ya que indica que ciertos tipos de violencia, especialmente el abandono, pueden afectar tanto a los jóvenes como a las personas mayores, reflejando posiblemente vulnerabilidades específicas de estas etapas de vida. En conclusión, esta tabla evidencia una relación clara entre la edad y los tipos de violencia cometidos, con una mayor probabilidad de actos violentos en edades jóvenes y una disminución progresiva en etapas avanzadas, aunque con persistencia de ciertos tipos de violencia en estos últimos grupos.


## Análisis general del género de los agresores de violencia de género

```{r,echo=FALSE,warning=FALSE}
genero_agresores_count <- table(violencia_genero$sexo_agre)

percentages <- round(genero_agresores_count / sum(genero_agresores_count) * 100, 1)

labels <- paste(names(genero_agresores_count), "\n", genero_agresores_count, " (", percentages, "%)", sep = "")

colors <- c("lightblue", "deepskyblue", "dodgerblue4")

par(mar = c(1, 2, 2, 1))  

pie(genero_agresores_count, labels = labels, col = colors, 
    main = "Distribución de Agresores por Género", border = "black", 
    clockwise = TRUE, init.angle = 90)

```

La gráfica de distribución de agresores por género revela una notable diferencia en la representación de cada grupo. La mayoría de los agresores se identifican como masculinos, con un 58.6% (7,141 casos), lo cual destaca una clara tendencia de predominio masculino en los actos de violencia. En contraste, el grupo femenino representa el 41.3% (5,040 casos), indicando que, aunque es menor, también tiene una presencia significativa en los registros de agresores. Es importante señalar que la proporción de personas identificadas como intersexuales es extremadamente baja, con solo un 0.1% (12 casos), lo cual podría deberse tanto a factores de subregistro como a la baja prevalencia de esta identificación de género en la base de datos. Esta distribución de género de los agresores sugiere que las intervenciones preventivas y de educación deben tener en cuenta la predominancia masculina, pero sin dejar de lado la relevancia de otros géneros, ya que ambos tienen una presencia notable en la perpetuación de la violencia. Este análisis también resalta la importancia de una mejor recolección de datos que incluya a todos los géneros, para proporcionar una visión completa del perfil de los agresores y poder diseñar políticas de prevención efectivas y específicas.

### Análisis de la relación entre el género  y los intervalos de edad del agresor

```{r, echo=FALSE, warning=FALSE, results='hide'}
library(dplyr)
library(kableExtra)

violencia_genero$edad_agre <- as.numeric(as.character(violencia_genero$edad_agre))
violencia_genero <- violencia_genero %>% filter(!is.na(edad_agre) & edad_agre >= 0 & edad_agre <= 100)

violencia_genero$edad_intervalo_agresor <- cut(
  violencia_genero$edad_agre, 
  breaks = c(seq(0, 90, by = 10), 100), 
  labels = c("[0-10)", "[10-20)", "[20-30)", "[30-40)", "[40-50)", "[50-60)", "[60-70)", "[70-80)", "[80-90)", "[90-100]"),
  right = FALSE,
  include.lowest = TRUE
)

tabla_frecuencia_gea <- violencia_genero %>%
  group_by(edad_intervalo_agresor, sexo_agre) %>%
  summarise(frecuencia = n(), .groups = 'drop') %>%
  pivot_wider(names_from = sexo_agre, values_from = frecuencia, values_fill = list(frecuencia = 0))

names(tabla_frecuencia_gea)[names(tabla_frecuencia_gea) == "edad_intervalo_agresor"] <- "Intervalos de Edad"

tabla_frecuencia_gea %>%
  kable("html", align = "c", digits = 4, 
        caption = "Frecuencia de Agresores por Intervalo de Edad y Género") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")



```

La tabla de frecuencia de agresores por intervalo de edad y género muestra una distribución significativa en los diferentes grupos etarios, destacando tendencias importantes tanto en género como en edad. En los primeros intervalos de edad, como de 0 a 10 años, la presencia de agresores es mínima, con solo 5 casos femeninos y 29 masculinos. Esto es esperable debido a la baja probabilidad de que individuos de tan corta edad participen en conductas de agresión. A partir del intervalo de 10 a 20 años, la frecuencia de agresores aumenta considerablemente, especialmente en el género masculino, con 692 casos frente a 541 en el género femenino.

El intervalo de edad de 20 a 30 años presenta la mayor frecuencia absoluta de agresores en ambos géneros, con 1,519 casos en mujeres y 1,335 en hombres, lo que sugiere que esta etapa de la vida es particularmente crítica en términos de conductas agresivas. Este patrón continúa siendo alto en el intervalo de 30 a 40 años, con 984 casos femeninos y 1,193 masculinos, aunque ya se observa una ligera disminución respecto al intervalo anterior.A partir de los 40 años, se observa una tendencia de disminución progresiva en el número de agresores, en ambos géneros, lo que podría estar relacionado con factores sociales y personales, como la madurez emocional y la reducción de conductas impulsivas. No obstante, aún persisten casos relevantes en intervalos como el de 50 a 60 años, donde se registran 369 casos femeninos y 675 masculinos.

En los intervalos de edades avanzadas, como de 70 a 80 y 80 a 90 años, los casos siguen disminuyendo, pero se mantiene cierta frecuencia, especialmente en el género masculino. Es interesante observar que, incluso en el último intervalo de edad (90-100 años), hay 261 casos femeninos y 570 masculinos, lo que indica que la violencia no es exclusiva de edades tempranas o intermedias. El grupo intersexual tiene una representación mínima en todos los intervalos de edad, con un máximo de 3 casos en el grupo de 90-100 años. Esta baja frecuencia podría reflejar tanto la baja prevalencia como posibles subregistros en la identificación de género. En conclusión, esta distribución por intervalo de edad y género sugiere que la juventud y la adultez temprana son las etapas más críticas en términos de participación en actos de agresión, especialmente en el género masculino, pero también con una significativa representación femenina. 


### Análisis de la relación entre el género del agresor y los tipos de violencia de género reportados

```{r, echo=FALSE, warning=FALSE}
library(dplyr)
library(kableExtra)

tabla_frecuencia_violencia_genero1 <- violencia_genero %>%
  group_by(def_naturaleza, sexo_agre) %>%
  summarise(frecuencia = n(), .groups = 'drop') %>%
  pivot_wider(names_from = sexo_agre, values_from = frecuencia, values_fill = list(frecuencia = 0))

names(tabla_frecuencia_violencia_genero1)[names(tabla_frecuencia_violencia_genero1) == "def_naturaleza"] <- "Tipo de Violencia"

tabla_frecuencia_violencia_genero1 %>%
  kable("html", align = "c", digits = 2, 
        caption = "Frecuencia de Agresores por Tipo de Violencia y Género") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"), 
                full_width = F, position = "center") %>%
  row_spec(0, bold = TRUE, background = "#d0e4f5")


```

La tabla de frecuencia de agresores por tipo de violencia y género revela patrones específicos en cuanto a la participación de agresores masculinos, femeninos e intersexuales en diversos tipos de violencia de género. En primer lugar, se observa que los hombres constituyen una mayoría significativa en varios tipos de violencia. En particular, en casos de abuso sexual y violencia física, los agresores masculinos representan la mayoría, con 881 y 3,038 casos respectivamente, frente a 70 y 987 casos de agresoras femeninas. Este patrón resalta que ciertos tipos de violencia, especialmente aquellos que involucran contacto físico directo, son cometidos principalmente por hombres.

La violencia de negligencia y abandono es un caso excepcional en el que las mujeres representan la mayoría de los agresores, con 3,740 casos frente a 1,004 casos de agresores masculinos. Esto podría sugerir que la negligencia y abandono están asociados con roles sociales y familiares, donde las mujeres tienen una mayor responsabilidad en el cuidado y, en situaciones de conflicto, pueden ser las principales agresoras en este contexto. Para tipos de violencia menos frecuentes, como otros actos sexuales y otras violencias sexuales, los números son bajos, pero nuevamente predomina la presencia masculina. Esto refleja que, incluso en formas menos comunes de violencia, el género masculino sigue teniendo una representación predominante.

El grupo intersexual muestra una baja representación en todos los tipos de violencia, con un máximo de 3 casos en violencia física y 2 casos en abuso sexual y otras violencias sexuales. Esto podría estar relacionado tanto con la menor población de personas intersexuales como con posibles limitaciones en la identificación de género en los registros. En cuanto a violencia psicológica, aunque los casos masculinos (418) superan a los femeninos (125), la brecha es menos pronunciada en comparación con otros tipos de violencia física. Esto sugiere que tanto hombres como mujeres participan en conductas de violencia psicológica, reflejando una distribución más equilibrada en este tipo de agresión no física.

En general, esta distribución sugiere una marcada diferencia de género en la participación en distintos tipos de violencia. Los hombres tienden a ser los principales agresores en la mayoría de los tipos de violencia de género, especialmente aquellos que involucran contacto físico directo. La excepción significativa es la negligencia y abandono, donde las mujeres representan la mayoría. Esta información es fundamental para el diseño de políticas y programas de prevención enfocados en abordar los factores de riesgo específicos asociados con cada tipo de violencia y género.

A continuación se presenta una tabla que expone las probabilidades condicionales de que un agresor, en función de su género, se encuentre en un intervalo de edad específico dado el tipo de violencia que ejerce, considerando únicamente los 3 casos de violencia más registrados para facilidad del análisis. Al analizar estos datos, se pueden identificar patrones de riesgo asociados a ciertos tipos de violencia según las características demográficas de los agresores, lo que permite una comprensión más precisa de los perfiles comunes en cada tipo de agresión.

```{r,echo=FALSE,warning=FALSE, message=FALSE, results='hide'}
library(dplyr)
library(DT)

edad_intervals <- c("[0-10)", "[10-20)", "[20-30)", "[30-40)", "[40-50)", "[50-60)", "[60-70)", "[70-80)", "[80-90)", "[90-100]")

tipos_principales_agresores <- c("Negligencia y abandono", "Violencia física", "Abuso sexual")
data_filtrada_agresores <- violencia_genero %>%
  filter(def_naturaleza %in% tipos_principales_agresores) %>%
  mutate(intervalo_edad_agresor = cut(
    edad_agre,
    breaks = c(seq(0, 90, by = 10), 100),
    labels = edad_intervals,
    right = FALSE,
    include.lowest = TRUE
  ))

total_por_violencia <- data_filtrada_agresores %>%
  group_by(def_naturaleza) %>%
  summarise(total_violencia = n(), .groups = 'drop')

conteo_violencia_genero_edad <- data_filtrada_agresores %>%
  group_by(def_naturaleza, sexo_agre, intervalo_edad_agresor) %>%
  summarise(frecuencia = n(), .groups = 'drop') 

print(head(conteo_violencia_genero_edad))
print(head(total_por_violencia))

tabla_probabilidades_violencia <- conteo_violencia_genero_edad %>%
  left_join(total_por_violencia, by = "def_naturaleza") %>%
  mutate(
    probabilidad = round(frecuencia / total_violencia, 4),
    porcentaje = paste0(round(probabilidad * 100, 2), "%"),
    enunciado = paste0("P(", sexo_agre, " ∩ ", intervalo_edad_agresor, " | ", def_naturaleza, ")")
  ) %>%
  arrange(factor(def_naturaleza, levels = tipos_principales_agresores)) %>%
  select(enunciado, probabilidad, porcentaje)

datatable(tabla_probabilidades_violencia, 
          colnames = c("Enunciado", "Probabilidad", "Porcentaje"),
          caption = "Probabilidades Condicionales de Género y Edad Dado el Tipo de Violencia",
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")), 
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("probabilidad"), digits = 4)

```

En el caso de "Negligencia y abandono" en agresores femeninos, las probabilidades más altas se observan en el intervalo de edad de 20 a 30 años, con una probabilidad de 26.61%, seguida por los intervalos de 10 a 20 años y 30 a 40 años. Esto sugiere que los eventos de negligencia y abandono perpetrados por mujeres tienden a concentrarse en individuos más jóvenes. Este patrón puede interpretarse como un indicador de ciertos factores sociales o económicos que afectan a este grupo de edad.

Para agresores masculinos en el mismo tipo de violencia, las probabilidades más altas se encuentran en los intervalos de edad de 20 a 30 y 30 a 40 años, aunque con valores menores comparados a sus contrapartes femeninas. Este detalle es significativo porque podría sugerir que, dentro de este tipo de violencia, las mujeres jóvenes tienen una mayor propensión a involucrarse en situaciones de negligencia y abandono. En el caso de "Violencia física", observamos una distribución más equilibrada, con agresores masculinos predominando en intervalos de edad de 50 a 60 y 60 a 70 años, con probabilidades cercanas al 6% en cada intervalo. Esto puede interpretarse como una presencia significativa de violencia física perpetrada por hombres de mediana edad, lo que podría estar relacionado con factores de agresividad o contextos culturales en edades avanzadas.

Finalmente, en "Abuso sexual", es interesante notar que la probabilidad se distribuye de manera que los hombres mayores (en el rango de 40 a 50 años y en adelante) presentan una probabilidad más elevada, alcanzando hasta un 20.06% en algunos intervalos. Este dato subraya la prevalencia de agresores masculinos en edades avanzadas en este tipo de violencia, lo cual puede estar influenciado por factores individuales y contextuales que persisten con la edad.


### Análisis del parentezco del agresor con la víctima

```{r,echo=FALSE,warning=FALSE}
parentesco_counts <- violencia_genero %>%
  filter(!is.na(parentezco_vict)) %>%
  count(parentezco_vict) %>%
  arrange(desc(n))

ggplot(parentesco_counts, aes(x = reorder(parentezco_vict, n), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = n), hjust = -0.2, color = "black", size = 3.5) + 
  coord_flip() +
  labs(
    title = "Frecuencia de casos de violencia por\nparentesco del agresor con la víctima",
    x = "Parentesco con la Víctima",
    y = "Casos Registrados"
  ) +
  theme_classic() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title.x = element_text(face = "bold", size = 12),
    axis.title.y = element_text(face = "bold", size = 12),
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.line = element_line(color = "gray50", size = 0.5), 
    panel.grid.major.x = element_line(color = "gray80", size = 0.3), 
    panel.grid.minor = element_blank()
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)))

```

Esta gráfica muestra la frecuencia de casos de violencia de género según el parentesco entre el agresor y la víctima. Se observa que el rol de "Madre" es el más alto, con 3,973 casos registrados, lo que podría señalar una prevalencia significativa de violencia dentro del ámbito familiar cercano. En segundo lugar, los agresores sin vínculo familiar directo ("Ninguno") representan 2,227 casos, lo cual indica que la violencia también ocurre fuera del núcleo familiar.

Las relaciones de pareja, tanto actuales como pasadas, representan un número considerable de casos, con "Pareja" acumulando 1,490 casos y "Ex pareja" 723 casos, lo que resalta la persistencia de la violencia en relaciones sentimentales, incluso después de su finalización. Otros miembros familiares, como "Padre" (980 casos) y "Familiar" (1,214 casos), también contribuyen de manera importante, lo que destaca la complejidad de la violencia dentro del entorno familiar.

Otros roles como "Esposo," "Compañero permanente," y "Novio(a)" también aparecen en la gráfica, aunque con menos frecuencia, indicando que las relaciones sentimentales y de convivencia tienen una relevancia particular en estos casos. Las categorías con menos frecuencia, como "Amante," "Madrasta," y "Sobrino(a)," sugieren una menor incidencia de violencia de género en relaciones menos comunes o periféricas.

En general, esta distribución refleja cómo las dinámicas familiares y las relaciones sentimentales son contextos en los que, lamentablemente, la violencia de género se presenta con mayor frecuencia, lo cual enfatiza la necesidad de intervenciones dirigidas tanto a la prevención en el entorno familiar como en el ámbito de las relaciones interpersonales.

Para observar lo anterior con mayor claridad, se procederá a presentar una tabla que presenta las probabilidades asociadas a los distintos tipos de parentesco entre el agresor y la víctima en casos de violencia de género. El análisis de estas relaciones permite identificar los vínculos familiares y personales que predominan en los incidentes reportados, proporcionando una base para comprender mejor el contexto de estos actos y orientar intervenciones preventivas específicas.

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(dplyr)
library(DT)
parentesco_counts <- violencia_genero %>%
  count(parentezco_vict, name = "cantidad")

total_casos4 <- sum(parentesco_counts$cantidad)

tabla_probabilidades_parentesco <- parentesco_counts %>%
  mutate(
    probabilidad = round(cantidad / total_casos4, 4),
    porcentaje = paste0(round(probabilidad * 100, 2), "%"),
    enunciado = paste0("P(", parentezco_vict, ")")
  ) %>%
  select(enunciado, probabilidad, porcentaje)

datatable(tabla_probabilidades_parentesco, 
          colnames = c("Enunciado", "Probabilidad", "Porcentaje"),
          caption = "Probabilidades de Cada Tipo de Parentesco entre el Agresor y la Víctima",
          options = list(pageLength = 10, 
                         scrollX = TRUE, 
                         dom = 'tpi', 
                         columnDefs = list(list(className = 'dt-center', targets = "_all")), 
                         initComplete = JS(
                           "function(settings, json) {",
                           "$(this.api().table().header()).css({'background-color': '#d0e4f5', 'color': '#000'});",
                           "}")),
          class = "cell-border stripe") %>%  
  formatRound(columns = c("probabilidad"), digits = 4)

```

Como se evidencia, la probabilidad más alta corresponde a la figura materna, con un valor de 0.3258 o 32.58%. Esto indica que existe una alta prevalencia de casos en los que el vínculo entre el agresor y la víctima es la madre, lo cual puede ser indicativo de contextos de dependencia y convivencia prolongada en entornos familiares. Las relaciones de pareja, que incluyen tanto parejas actuales como exparejas, también muestran probabilidades notables de 12.22% y 5.93%, respectivamente. La presencia de estos eventos en la categoría de agresores refleja que los incidentes de violencia son recurrentes en relaciones íntimas, donde la cercanía emocional y la convivencia pueden aumentar el riesgo de conflictos que derivan en agresión. En términos probabilísticos, la probabilidad de que el agresor sea la pareja actual o una expareja es considerablemente mayor en comparación con relaciones más periféricas.

En contraste, los eventos en los que el agresor es un familiar distante o con un vínculo más periférico, como un primo (0.26%) o un suegro (0.05%), presentan probabilidades significativamente menores. Esto sugiere que los incidentes de violencia de género tienden a ocurrir con menor frecuencia en relaciones menos cercanas o en aquellas donde el nivel de interacción cotidiana es menor. A nivel probabilístico, esta distribución muestra una concentración de eventos en las relaciones familiares cercanas y de pareja. Este patrón implica que los eventos de violencia no se distribuyen de manera uniforme entre todos los tipos de relaciones, sino que se concentran en contextos de alta interacción y cercanía emocional. La probabilidad condicionada de que el agresor sea un familiar directo o una pareja es mucho mayor en comparación con otros tipos de relación. Este tipo de análisis probabilístico subraya la necesidad de medidas preventivas y de intervención específicamente dirigidas a los entornos familiares e íntimos, donde el riesgo de agresión es más elevado según los datos registrados.

### Análisis de agresores con y sin antecedentes 

```{r,echo=FALSE, warning=FALSE}
antecedentes_agresores_count <- table(violencia_genero$antecedentes_agresor)

percentages_antecedentes <- round(antecedentes_agresores_count / sum(antecedentes_agresores_count) * 100, 1)

labels <- paste(names(antecedentes_agresores_count), "\n", antecedentes_agresores_count, " (", percentages_antecedentes, "%)", sep = "")

colors <- c("lightblue", "deepskyblue", "dodgerblue4")

par(mar = c(1, 2, 2, 1))  

pie(antecedentes_agresores_count, labels = labels, col = colors, 
    main = "Distribución de Agresores por Antecedentes", border = "black", 
    clockwise = TRUE, init.angle = 90)

```

En esta gráfica sobre la distribución de agresores según sus antecedentes, observamos tres sucesos: aquellos con antecedentes conocidos (representados como "Sí"), aquellos sin antecedentes ("No") y un grupo de casos donde la información es desconocida. El hecho de que el 41% de los agresores tenga antecedentes sugiere que es muy probable que un historial previo de comportamiento violento esté presente en una porción considerable de esta población. Esto podría indicar una tendencia o patrón de reincidencia, hecho que refuerza la probabilidad de que los antecedentes sean un factor de riesgo importante a considerar en el análisis de conductas violentas.

Por otro lado, el 35.3% de los agresores sin antecedentes muestra que una fracción relevante de esta población comete actos de violencia sin historial previo, un suceso que puede indicar que factores externos o contextuales desencadenan el comportamiento agresivo en estas personas, sin que necesariamente haya una predisposición documentada. El grupo de datos desconocidos, que representa el 23.7%, introduce un nivel de incertidumbre en el análisis. Este suceso de “información faltante” muestra que es probable que el desconocimiento de antecedentes limite una interpretación completa de los patrones de riesgo. En términos probabilísticos, esta categoría afecta la capacidad de precisar las probabilidades de reincidencia o de identificar factores de riesgo asociados a los antecedentes en los agresores.

En conjunto, la distribución observada en esta gráfica apunta a que, dentro de esta población, es probable que los antecedentes sean un factor influyente en la conducta violenta, aunque también es común la aparición de agresores sin antecedentes previos, sugiriendo que los factores inmediatos o ambientales también juegan un rol relevante en la ocurrencia de estos sucesos.

### Análisis de la proporción de agresores capturados por los actos de violencia de género

```{r,echo=FALSE,warning=FALSE}
captura_agresores_count <- table(violencia_genero$captura_agresor)

percentages_captura<- round(captura_agresores_count / sum(captura_agresores_count) * 100, 1)

labels <- paste(names(captura_agresores_count), "\n", captura_agresores_count, " (", percentages_captura, "%)", sep = "")

colors <- c("lightblue", "deepskyblue", "dodgerblue4")

par(mar = c(1, 2, 2, 1))  

pie(captura_agresores_count, labels = labels, col = colors, 
    main = "Distribución de Agresores Capturados", border = "black", 
    clockwise = TRUE, init.angle = 90)

```

La gráfica presenta la distribución de agresores en función de su estado de captura, dividida en tres categorías: "Sí" para aquellos capturados (32%), "No" para los no capturados (35.3%), y "Desconocido" (32.7%) para los casos donde no se dispone de información. Esta distribución permite un análisis probabilístico relevante de los eventos de captura, ausencia de captura y falta de información. Desde una perspectiva de probabilidad, cada segmento representa un suceso distinto dentro de la población de agresores registrados. El suceso de captura (P(Captura = Sí)) muestra una probabilidad aproximada de 0.32, indicando que en poco menos de un tercio de los casos registrados se ha logrado detener al agresor. Este dato puede interpretarse como un indicador de la efectividad en las acciones de aprehensión, aunque limitado al análisis de los casos con información disponible.

La probabilidad de que un agresor no sea capturado, P(Captura = No), es de 0.353, ligeramente superior a la de captura. Esto sugiere que en más de un tercio de los casos, el suceso "no capturado" ocurre, un factor que podría ser indicativo de fallas en la respuesta judicial o de dificultades en la localización de los agresores. Al comparar estos dos sucesos, se observa que la probabilidad de no captura supera marginalmente la de captura, lo cual plantea interrogantes sobre la eficiencia del sistema de justicia en estos casos. Finalmente, el suceso "Desconocido" (P(Captura = Desconocido) ≈ 0.327) constituye una proporción considerable de la muestra. La presencia de un alto porcentaje de datos desconocidos introduce una variable de incertidumbre significativa, que limita la precisión de las estimaciones probabilísticas sobre la efectividad de la captura de agresores. En términos estadísticos, esta incertidumbre puede afectar la representatividad de las conclusiones, ya que la falta de información en casi un tercio de los casos reduce la claridad de la situación real.


# Otros análisis descriptivos relevantes sobre factores situacionales de los casos de violencia de género 

En este apartado, se presentan análisis descriptivos adicionales sobre factores situacionales en casos de violencia de género. Estos factores incluyen características como el tipo de seguridad social de la víctima y el consumo de sustancias al momento del incidente. Examinar estos elementos proporciona una visión más completa del contexto en el que ocurren estos casos y ayuda a identificar patrones que pueden ser clave para intervenciones más efectivas y focalizadas en la protección de las víctimas.

## Acceso a seguridad social de las víctimas registradas por violencia de género 

```{r,echo=FALSE, warning=FALSE}
library(plotly)


tfrec_seg <- table(violencia_genero$`Tipo de Seguridad Social`)

ds6 <- data.frame(
  labels = names(tfrec_seg), 
  values = as.numeric(tfrec_seg)
)

plot_ly(ds6, 
        labels = ~labels, 
        values = ~values, 
        type = "pie", 
        marker = list(
          colors = c("lightblue", "blue", "gray", 
                     "darkblue", "lightgreen", "#6baed6")
        )) %>%
  layout(title = "Diagrama circular de Tipo de Seguridad Social")

```

El diagrama circular representa la distribución de los tipos de seguridad social entre las víctimas de violencia de género, mostrando las probabilidades relativas de afiliación a cada régimen de seguridad social. La mayor parte de las víctimas de violencia de género están afiliadas a los regímenes subsidado y contributivo, que en conjunto representan aproximadamente el 88.4% de los casos. En detalle, el 45.6% de las víctimas están en el régimen contributivo, mientras que el 42.8% se encuentran en el régimen subsidiado. Esto indica que, en la población de víctimas de violencia de género, existe una alta probabilidad de que estén cubiertas por alguno de estos dos tipos de seguridad social, lo cual sugiere que tanto personas de sectores con ingresos estables (contributivo) como de sectores más vulnerables (subsidado) están afectadas por la violencia de género.

Por otro lado, una menor proporción de víctimas no tiene afiliación al sistema de seguridad social (6.54% en la categoría de No Afiliados), lo que significa que existe una probabilidad más baja de que una víctima de violencia de género carezca de cobertura social, aunque este grupo sigue representando una parte relevante en términos de vulnerabilidad. Las categorías de Excepción, Especial e Indeterminado tienen frecuencias mucho menores, con 2.81%, 1.04%, y 1.16% respectivamente, lo que indica una probabilidad muy baja de que las víctimas de violencia de género se encuentren afiliadas a estos regímenes. Estas categorías representan situaciones particulares y menos comunes en la población analizada, como afiliaciones especiales o casos donde la afiliación no está claramente definida.

En términos probabilísticos, si seleccionamos una víctima de violencia de género al azar, hay casi un 90% de probabilidad de que esté afiliada a un régimen contributivo o subsidiado y menos de un 10% de probabilidad de que esté en alguna de las otras categorías. Este análisis sugiere que la violencia de género afecta a personas en una amplia variedad de contextos socioeconómicos, tanto con acceso a seguridad social contributiva como en situaciones de subsidio o sin afiliación, subrayando la necesidad de apoyo integral en estas diversas condiciones de seguridad social.

Ahora bien, el análisis de la relación entre el estrato socioeconómico y el tipo de seguridad social también es clave para identificar desigualdades en el acceso a recursos y protección entre víctimas de violencia de género. Esta conexión ayuda a enfocar políticas de intervención en los grupos más vulnerables, especialmente aquellos con menor acceso a servicios de apoyo institucional, como se muestra a continuación: 

```{r,echo=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)

datos_resumidos_estrato_seguridad <- violencia_genero %>%
  group_by(grupo_estrato, `Tipo de Seguridad Social`) %>%
  summarise(total_casos = n(), .groups = 'drop')

ggplot(datos_resumidos_estrato_seguridad, aes(x = grupo_estrato, y = total_casos, fill = grupo_estrato)) +
  geom_bar(stat = "identity", width = 0.8) +
  geom_hline(yintercept = 0, color = "black", size = 0.5) +  
  geom_text(aes(label = total_casos), vjust = -0.3, size = 3) +
  scale_fill_manual(values = c("#1f78b4", "#6baed6", "#a6cee3", "#c6dbef", "#e0f3ff", "gray")) +
  scale_y_continuous(limits = c(0, 1800), expand = c(0, 0.05)) +  
  labs(
    title = "Distribución de Víctimas por Estrato y Tipo de Seguridad Social",
    x = "Estrato Socioeconómico",
    y = "Número de Casos",
    fill = "Estrato"
  ) +
  facet_wrap(~ `Tipo de Seguridad Social`) +
  theme_minimal() +
  theme(
    axis.text.x = element_blank(),  
    axis.title.x = element_blank(), 
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank(),
    axis.line.y = element_line(color = "black"), 
    plot.title = element_text(hjust = 0.5, face = "bold"),
    strip.text = element_text(face = "bold", size = 10)
  )


```

Como se observa, la mayoría de los casos de víctimas con seguridad social subsidiada y contributiva provienen de los estratos más bajos, lo cual resalta una fuerte asociación entre la vulnerabilidad económica y la exposición a la violencia. Específicamente, en el sistema contributivo, los estratos 1 y 2 concentran el mayor número de casos, con 1,542 y 1,059 víctimas respectivamente. Esto sugiere que, aunque estas personas tienen un sistema de seguridad social basado en contribuciones, los factores de riesgo de violencia siguen siendo altos en estos grupos de menor ingreso. El sistema subsidiado, que está diseñado para personas en situación de pobreza o extrema pobreza, también concentra una cantidad considerable de víctimas en los estratos 1 y 2, con 1,690 y 1,056 casos respectivamente. Este patrón confirma que las personas en los niveles socioeconómicos más bajos enfrentan una mayor exposición a la violencia, posiblemente debido a la combinación de factores como la precariedad económica y limitaciones en el acceso a recursos de protección y apoyo.

Otros tipos de seguridad social, como el sistema "Especial" y el de "Excepción," tienen una representación muy baja en todos los estratos, lo que indica que son menos comunes entre las víctimas de violencia de género en esta muestra. En el caso de las personas no afiliadas al sistema de seguridad social, se observa una prevalencia notable en los estratos más bajos, especialmente en el estrato 1, lo cual evidencia una situación de alta vulnerabilidad: sin acceso a mecanismos de protección social, estas personas están aún más expuestas a las consecuencias negativas de la violencia.En conjunto, esta gráfica refleja cómo la situación socioeconómica y el tipo de seguridad social están vinculados a la prevalencia de casos de violencia de género. Los grupos de menores ingresos y con seguridad social subsidiada o sin afiliación se presentan como los más vulnerables, lo que subraya la necesidad de políticas públicas que enfoquen sus esfuerzos en estos sectores para prevenir la violencia y brindarles un mejor acceso a sistemas de apoyo y protección social.

## Presencia de alcohol u otras sustancias en la víctima durante el acto de violencia de género

```{r,echo=FALSE, warning=FALSE}

sust_vic_clean <- na.omit(violencia_genero$sust_vic)

sust_vic_count <- table(sust_vic_clean)

if (length(sust_vic_count) > 0) {

  percentages_sust <- round(sust_vic_count / sum(sust_vic_count) * 100, 1)

 
  labels <- paste(names(sust_vic_count), "\n", sust_vic_count, " (", percentages_sust, "%)", sep = "")

  
  colors <- c("lightblue", "steelblue", "dodgerblue4", "steelblue", "skyblue")


  par(mar = c(1, 2, 2, 1))


  pie(sust_vic_count, labels = labels, col = colors, 
      main = "Distribución de Sustancias en Víctimas", border = "black", 
      clockwise = TRUE, init.angle = 90, radius = 0.8)
} else {
  cat("No hay datos válidos en la variable 'sust_vic' para crear el gráfico de pastel.")
}

```

La gráfica muestra que, en el 98% de los casos de violencia de género, la víctima no había consumido alcohol u otras sustancias al momento del ataque, mientras que solo el 2% presentaba consumo de alguna sustancia. Esto sugiere una alta probabilidad (0.98) de que las víctimas se encuentren sobrias durante el incidente, lo que podría ofrecer información relevante sobre el contexto de estos casos y descartar el consumo de sustancias como un factor común entre las víctimas en la mayoría de los eventos de violencia. Estos resultados sugieren que el consumo de sustancias en las víctimas no es un factor determinante en la mayoría de los incidentes de violencia de género. La ausencia de influencia de sustancias en las víctimas podría indicar que estos actos no están necesariamente asociados con la vulnerabilidad inducida por el consumo de estas sustancias, sino que pueden ocurrir en cualquier contexto. Como recomendación, sería útil incluir datos sobre el consumo de sustancias en el agresor, ya que este factor situacional podría influir en la ocurrencia y gravedad de los incidentes. Incorporar esta información permitiría identificar patrones de riesgo y diseñar estrategias de prevención más efectivas.




